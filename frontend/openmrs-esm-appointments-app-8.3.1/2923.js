(globalThis.webpackChunk_openmrs_esm_appointments_app=globalThis.webpackChunk_openmrs_esm_appointments_app||[]).push([[2923],{6941:(t,n,e)=>{"use strict";e.d(n,{Z:()=>l});var r=e(5698),o=e.n(r),a=e(9613),i=e.n(a)()(o());i.push([t.id,".-esm-appointments__patient-appointments-cancel__modalHeader___yUwtk .cds--modal-close-button{position:absolute;inset-block-start:0;inset-inline-end:0;margin:0;margin-top:calc(-1 * 1rem)}.-esm-appointments__patient-appointments-cancel__modalHeader___yUwtk .cds--modal-close{background-color:rgba(0,0,0,0)}.-esm-appointments__patient-appointments-cancel__modalHeader___yUwtk .cds--modal-close:hover{background-color:var(--cds-layer-hover)}.-esm-appointments__patient-appointments-cancel__modalHeader___yUwtk .cds--popover--left>.cds--popover>.cds--popover-content{transform:translate(-4rem, 0.85rem)}.-esm-appointments__patient-appointments-cancel__modalHeader___yUwtk .cds--popover--left>.cds--popover>.cds--popover-caret{transform:translate(-3.75rem, 1.25rem)}","",{version:3,sources:["webpack://./src/patient-appointments/patient-appointments-cancel.scss"],names:[],mappings:"AAII,8FACE,iBAAA,CACA,mBAAA,CACA,kBAAA,CACA,QAAA,CACA,0BAAA,CAGF,uFACE,8BAAA,CAEA,6FACE,uCAAA,CAIJ,6HACE,mCAAA,CAGF,2HACE,sCAAA",sourcesContent:["@use '@carbon/layout';\n\n.modalHeader {\n  :global {\n    .cds--modal-close-button {\n      position: absolute;\n      inset-block-start: 0;\n      inset-inline-end: 0;\n      margin: 0;\n      margin-top: calc(-1 * #{layout.$spacing-05});\n    }\n\n    .cds--modal-close {\n      background-color: rgba(0, 0, 0, 0);\n\n      &:hover {\n        background-color: var(--cds-layer-hover);\n      }\n    }\n\n    .cds--popover--left > .cds--popover > .cds--popover-content {\n      transform: translate(-4rem, 0.85rem);\n    }\n\n    .cds--popover--left > .cds--popover > .cds--popover-caret {\n      transform: translate(-3.75rem, 1.25rem);\n    }\n  }\n}\n"],sourceRoot:""}]),i.locals={modalHeader:"-esm-appointments__patient-appointments-cancel__modalHeader___yUwtk"};const l=i},6824:function(t){t.exports=function(){"use strict";return function(t,n,e){n.prototype.isToday=function(){var t="YYYY-MM-DD",n=e();return this.format(t)===n.format(t)}}}()},2923:(t,n,e)=>{"use strict";e.r(n),e.d(n,{default:()=>T});var r=e(268),o=e.n(r),a=e(4924),i=e(1512),l=e(7234),s=e(8527),c=e(6062),u=e.n(c),p=e(4036),d=e.n(p),m=e(6793),f=e.n(m),v=e(7892),h=e.n(v),y=e(1173),b=e.n(y),A=e(2464),_=e.n(A),w=e(6941),g={};g.styleTagTransform=_(),g.setAttributes=h(),g.insert=f().bind(null,"head"),g.domAPI=d(),g.insertStyleElement=b(),u()(w.Z,g);const C=w.Z&&w.Z.locals?w.Z.locals:void 0;function k(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function S(t,n,e,r,o,a,i){try{var l=t[a](i),s=l.value}catch(t){return void e(t)}l.done?n(s):Promise.resolve(s).then(r,o)}const T=function(t){var n,e,c,u,p=t.closeCancelModal,d=t.appointmentUuid,m=t.patientUuid,f=(0,a.useTranslation)().t,v=(0,s.W)(m,(new Date).toUTCString(),new AbortController).mutate,h=(c=(0,r.useState)(!1),u=2,function(t){if(Array.isArray(t))return t}(c)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var r,o,a=[],i=!0,l=!1;try{for(e=e.call(t);!(i=(r=e.next()).done)&&(a.push(r.value),!n||a.length!==n);i=!0);}catch(t){l=!0,o=t}finally{try{i||null==e.return||e.return()}finally{if(l)throw o}}return a}}(c,u)||function(t,n){if(t){if("string"==typeof t)return k(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(e):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?k(t,n):void 0}}(c,u)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),y=h[0],b=h[1],A=(n=function(){return function(t,n){var e,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(a){return function(l){return function(a){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=n.call(t,i)}catch(t){a=[6,t],r=0}finally{e=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}}(this,(function(t){return b(!0),(0,s.q)("Cancelled",d).then((function(t){200===t.status&&(v(),p(),(0,l.showSnackbar)({isLowContrast:!0,kind:"success",subtitle:f("appointmentCancelledSuccessfully","Appointment cancelled successfully"),title:f("appointmentCancelled","Appointment cancelled")}))})).catch((function(t){var n;(0,l.showSnackbar)({title:f("appointmentCancelError","Error cancelling appointment"),kind:"error",isLowContrast:!0,subtitle:null===(n=t)||void 0===n?void 0:n.message})})),[2]}))},e=function(){var t=this,e=arguments;return new Promise((function(r,o){var a=n.apply(t,e);function i(t){S(a,r,o,i,l,"next",t)}function l(t){S(a,r,o,i,l,"throw",t)}i(void 0)}))},function(){return e.apply(this,arguments)});return o().createElement("div",null,o().createElement(i.xBx,{className:C.modalHeader,closeModal:p,title:f("cancelAppointment","Cancel appointment")}),o().createElement(i.fef,null,o().createElement("p",null,f("cancelAppointmentModalConfirmationText","Are you sure you want to cancel this appointment?"))),o().createElement(i.mzw,null,o().createElement(i.zxk,{kind:"secondary",onClick:p},f("discard","Discard")),o().createElement(i.zxk,{kind:"danger",onClick:A,disabled:y},f("cancelAppointment","Cancel appointment"))))}},8527:(t,n,e)=>{"use strict";e.d(n,{W:()=>p,q:()=>f});var r=e(8879),o=e.n(r),a=e(3649),i=e(7234),l=e(6824),s=e.n(l);function c(t,n,e,r,o,a,i){try{var l=t[a](i),s=l.value}catch(t){return void e(t)}l.done?n(s):Promise.resolve(s).then(r,o)}o().extend(s());var u="".concat(i.restBaseUrl,"/appointments/search");function p(t,n,e){var r,l,s,c,p,d,m,f,v,h,y,b=(0,a.ZP)(u,(function(){return(0,i.openmrsFetch)(u,{method:"POST",signal:e.signal,headers:{"Content-Type":"application/json"},body:{patientUuid:t,startDate:n}})})),A=b.data,_=b.error,w=b.isLoading,g=b.isValidating,C=b.mutate,k=(null===(l=A)||void 0===l||null===(r=l.data)||void 0===r?void 0:r.length)?A.data:null,S=null===(p=k)||void 0===p||null===(c=p.sort((function(t,n){return n.startDateTime>t.startDateTime?1:-1})))||void 0===c||null===(s=c.filter((function(t){return"Cancelled"!==t.status})))||void 0===s?void 0:s.filter((function(t){var n=t.startDateTime;return o()(new Date(n).toISOString()).isBefore((new Date).setHours(0,0,0,0))})),T=null===(f=k)||void 0===f||null===(m=f.sort((function(t,n){return t.startDateTime>n.startDateTime?1:-1})))||void 0===m||null===(d=m.filter((function(t){return"Cancelled"!==t.status})))||void 0===d?void 0:d.filter((function(t){var n=t.startDateTime;return o()(new Date(n).toISOString()).isAfter(new Date)})),D=null===(y=k)||void 0===y||null===(h=y.sort((function(t,n){return t.startDateTime>n.startDateTime?1:-1})))||void 0===h||null===(v=h.filter((function(t){return"Cancelled"!==t.status})))||void 0===v?void 0:v.filter((function(t){var n=t.startDateTime;return o()(new Date(n).toISOString()).isToday()}));return{data:A?{pastAppointments:S,upcomingAppointments:T,todaysAppointments:D}:null,error:_,isLoading:w,isValidating:g,mutate:C}}var d,m,f=(d=function(t,n){var e,r,a;return function(t,n){var e,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(a){return function(l){return function(a){if(e)throw new TypeError("Generator is already executing.");for(;i;)try{if(e=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=n.call(t,i)}catch(t){a=[6,t],r=0}finally{e=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}}(this,(function(l){switch(l.label){case 0:return e=Intl.DateTimeFormat().resolvedOptions().timeZone,r=o()(new Date).format("YYYY-MM-DDTHH:mm:ss.SSSZZ"),a="".concat(i.restBaseUrl,"/appointments/").concat(n,"/status-change"),[4,(0,i.openmrsFetch)(a,{body:{toStatus:t,onDate:r,timeZone:e},method:"POST",headers:{"Content-Type":"application/json"}})];case 1:return[2,l.sent()]}}))},m=function(){var t=this,n=arguments;return new Promise((function(e,r){var o=d.apply(t,n);function a(t){c(o,e,r,a,i,"next",t)}function i(t){c(o,e,r,a,i,"throw",t)}a(void 0)}))},function(t,n){return m.apply(this,arguments)})}}]);