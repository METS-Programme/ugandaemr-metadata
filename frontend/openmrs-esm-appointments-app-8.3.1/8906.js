(globalThis.webpackChunk_openmrs_esm_appointments_app=globalThis.webpackChunk_openmrs_esm_appointments_app||[]).push([[8906],{8029:(n,e,t)=>{"use strict";t.d(e,{Z:()=>s});var r=t(5698),a=t.n(r),o=t(9613),i=t.n(o)()(a());i.push([n.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79;--bottom-nav-height: 4rem;--workspace-header-height: 3rem;--tablet-workspace-window-height: calc(100vh - var(--omrs-navbar-height) - var(--bottom-nav-height));--desktop-workspace-window-height: calc(100vh - var(--omrs-navbar-height) - var(--workspace-header-height))}.-esm-appointments__end-appointment-modal__modalHeader___zPlRT .cds--modal-close-button{position:absolute;inset-block-start:0;inset-inline-end:0;margin:0;margin-top:calc(-1 * 1rem)}.-esm-appointments__end-appointment-modal__modalHeader___zPlRT .cds--modal-close{background-color:rgba(0,0,0,0)}.-esm-appointments__end-appointment-modal__modalHeader___zPlRT .cds--modal-close:hover{background-color:var(--cds-layer-hover)}.-esm-appointments__end-appointment-modal__modalHeader___zPlRT .cds--popover--left>.cds--popover>.cds--popover-content{transform:translate(-4rem, 0.85rem)}.-esm-appointments__end-appointment-modal__modalHeader___zPlRT .cds--popover--left>.cds--popover>.cds--popover-caret{transform:translate(-3.75rem, 1.25rem)}","",{version:3,sources:["webpack://./../../node_modules/@openmrs/esm-styleguide/src/_vars.scss","webpack://./src/appointments/common-components/end-appointment.modal.scss"],names:[],mappings:"AAoDA,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CACA,yBAAA,CACA,+BAAA,CACA,oGAAA,CACA,2GAAA,CCtDE,wFACE,iBAAA,CACA,mBAAA,CACA,kBAAA,CACA,QAAA,CACA,0BAAA,CAGF,iFACE,8BAAA,CAEA,uFACE,uCAAA,CAIJ,uHACE,mCAAA,CAGF,qHACE,sCAAA",sourcesContent:["$ui-01: #f4f4f4;\n$ui-02: #ffffff;\n$ui-03: #e0e0e0;\n$ui-04: #8d8d8d;\n$ui-05: #161616;\n$text-02: #525252;\n$text-03: #a8a8a8;\n$ui-background: #ffffff;\n$color-gray-30: #c6c6c6;\n$color-gray-70: #525252;\n$color-gray-100: #161616;\n$color-blue-60-2: #0f62fe;\n$color-blue-10: #edf5ff;\n$color-yellow-50: #feecae;\n$carbon--red-50: #fa4d56;\n$inverse-link: #78a9ff;\n$support-02: #24a148;\n$inverse-support-03: #f1c21b;\n$warning-background: #fff8e1;\n$openmrs-background-grey: #f4f4f4;\n$danger: #da1e28;\n$interactive-01: #0f62fe;\n$field-01: #f4f4f4;\n$grey-2: #e0e0e0;\n$labeldropdown: #c6c6c6;\n\n$brand-primary-10: #d9fbfb;\n$brand-primary-20: #9ef0f0;\n$brand-primary-30: #3ddbd9;\n$brand-primary-40: #08bdba;\n$brand-primary-50: #009d9a;\n\n/* 60,70 and 80 are already declared as brand-01, 02 and 03 respectively */\n\n$brand-primary-90: #022b30;\n$brand-primary-100: #081a1c;\n\n@mixin brand-01($property) {\n  #{$property}: #005d5d;\n  #{$property}: var(--brand-01);\n}\n\n@mixin brand-02($property) {\n  #{$property}: #004144;\n  #{$property}: var(--brand-02);\n}\n\n@mixin brand-03($property) {\n  #{$property}: #007d79;\n  #{$property}: var(--brand-03);\n}\n\n:root {\n  --brand-01: #005d5d;\n  --brand-02: #004144;\n  --brand-03: #007d79;\n  --bottom-nav-height: 4rem;\n  --workspace-header-height: 3rem;\n  --tablet-workspace-window-height: calc(100vh - var(--omrs-navbar-height) - var(--bottom-nav-height));\n  --desktop-workspace-window-height: calc(100vh - var(--omrs-navbar-height) - var(--workspace-header-height));\n}\n\n$breakpoint-phone-min: 0px;\n$breakpoint-phone-max: 600px;\n$breakpoint-tablet-min: 601px;\n$breakpoint-tablet-max: 1023px;\n$breakpoint-small-desktop-min: 1024px;\n$breakpoint-small-desktop-max: 1439px;\n$breakpoint-large-desktop-min: 1440px;\n$breakpoint-large-desktop-max: 99999999px;\n\n/* These color variables will be removed in a future release */\n$brand-teal-01: #007d79;\n$brand-01: #005d5d;\n$brand-02: #004144;\n","@use '@carbon/layout';\n@use '@openmrs/esm-styleguide/src/vars' as *;\n\n.modalHeader {\n  :global {\n    .cds--modal-close-button {\n      position: absolute;\n      inset-block-start: 0;\n      inset-inline-end: 0;\n      margin: 0;\n      margin-top: calc(-1 * #{layout.$spacing-05});\n    }\n\n    .cds--modal-close {\n      background-color: rgba(0, 0, 0, 0);\n\n      &:hover {\n        background-color: var(--cds-layer-hover);\n      }\n    }\n\n    .cds--popover--left > .cds--popover > .cds--popover-content {\n      transform: translate(-4rem, 0.85rem);\n    }\n\n    .cds--popover--left > .cds--popover > .cds--popover-caret {\n      transform: translate(-3.75rem, 1.25rem);\n    }\n  }\n}\n"],sourceRoot:""}]),i.locals={modalHeader:"-esm-appointments__end-appointment-modal__modalHeader___zPlRT"};const s=i},6824:function(n){n.exports=function(){"use strict";return function(n,e,t){e.prototype.isToday=function(){var n="YYYY-MM-DD",e=t();return this.format(n)===e.format(n)}}}()},8906:(n,e,t)=>{"use strict";t.r(e),t.d(e,{default:()=>_});var r=t(268),a=t.n(r),o=t(4924),i=t(1512),s=t(7234),l=t(8527),c=t(3291),p=t(6062),d=t.n(p),u=t(4036),m=t.n(u),f=t(6793),h=t.n(f),b=t(7892),v=t.n(b),A=t(1173),y=t.n(A),g=t(2464),k=t.n(g),w=t(8029),C={};C.styleTagTransform=k(),C.setAttributes=v(),C.insert=h().bind(null,"head"),C.domAPI=m(),C.insertStyleElement=y(),d()(w.Z,C);const $=w.Z&&w.Z.locals?w.Z.locals:void 0,_=function(n){var e=n.patientUuid,t=n.appointmentUuid,p=n.closeModal,d=(0,o.useTranslation)().t,u=(0,s.useVisit)(e),m=u.activeVisit,f=u.mutate,h=(0,c.EJ)().mutateAppointments,b=(0,r.useCallback)((function(){(0,l.q)("Completed",t).then((function(){if(h(),m){var n=new AbortController,e={stopDatetime:new Date};return(0,s.updateVisit)(m.uuid,e,n).then((function(){(0,s.showSnackbar)({title:d("appointmentEnded","Appointment ended"),subtitle:d("appointmentEndedAndVisitClosedSuccessfully","Appointment successfully ended and visit successfully closed"),isLowContrast:!0,kind:"success"}),f()})).catch((function(n){var e;(0,s.showSnackbar)({title:d("appointmentEndedButVisitNotClosedError","Appointment ended successfully, but there was an error closing the visit."),subtitle:null===(e=n)||void 0===e?void 0:e.message,kind:"error",isLowContrast:!0})}))}(0,s.showSnackbar)({title:d("appointmentEnded","Appointment ended"),subtitle:d("appointmentEndedSuccessfully","Appointment successfully ended."),isLowContrast:!0,kind:"success"})})).catch((function(n){var e;(0,s.showSnackbar)({title:d("appointmentEndError","Error ending appointment"),subtitle:null===(e=n)||void 0===e?void 0:e.message,kind:"error",isLowContrast:!0})})).finally((function(){p()}))}),[m,t,p,f,h,d]);return a().createElement(a().Fragment,null,a().createElement(i.xBx,{className:$.modalHeader,closeModal:p,title:d("endAppointmentConfirmation","Are you sure you want to check the patient out for this appointment?")}),a().createElement(i.fef,null,a().createElement("p",null,m?d("endAppointmentAndVisitConfirmationMessage","Checking the patient out will mark the appointment as complete and close out the active visit for this patient."):d("endAppointmentConfirmationMessage","Checking the patient out will mark the appointment as complete."))),a().createElement(i.mzw,null,a().createElement(i.zxk,{kind:"secondary",onClick:p},d("cancel","Cancel")),a().createElement(i.zxk,{kind:"danger",onClick:b},d("checkOut","Check out"))))}},3291:(n,e,t)=>{"use strict";t.d(e,{Ae:()=>v,EA:()=>A,EJ:()=>f,GB:()=>b,l9:()=>h});var r=t(268),a=t(8879),o=t.n(a),i=t(6824),s=t.n(i),l=t(3649),c=t(7234);function p(n,e,t,r,a,o,i){try{var s=n[o](i),l=s.value}catch(n){return void t(n)}s.done?e(l):Promise.resolve(l).then(r,a)}function d(n){return function(){var e=this,t=arguments;return new Promise((function(r,a){var o=n.apply(e,t);function i(n){p(o,r,a,i,s,"next",n)}function s(n){p(o,r,a,i,s,"throw",n)}i(void 0)}))}}function u(n,e){var t,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=e.call(n,i)}catch(n){o=[6,n],r=0}finally{t=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}o().extend(s());var m="".concat(c.restBaseUrl,"/appointment");function f(){var n=(0,l.kY)().mutate;return{mutateAppointments:(0,r.useCallback)((function(){return n((function(n){return"string"==typeof n&&n.startsWith(m)||Array.isArray(n)&&n[0].startsWith(m)}))}),[n])}}function h(){var n=(0,l.ZP)("".concat(c.restBaseUrl,"/appointmentService/all/full"),c.openmrsFetch),e=n.data,t=n.error,r=n.isLoading;return{data:e?e.data:null,error:t,isLoading:r}}function b(n,e){return(0,c.openmrsFetch)("".concat(c.restBaseUrl,"/appointment"),{method:"POST",signal:e.signal,headers:{"Content-Type":"application/json"},body:n})}function v(n,e){return(0,c.openmrsFetch)("".concat(c.restBaseUrl,"/recurring-appointments"),{method:"POST",signal:e.signal,headers:{"Content-Type":"application/json"},body:n})}"".concat(c.restBaseUrl,"/appointments/search"),d((function(n,e){var t,r,a;return u(this,(function(i){switch(i.label){case 0:return t=Intl.DateTimeFormat().resolvedOptions().timeZone,r=o()(new Date).format("YYYY-MM-DDTHH:mm:ss.SSSZZ"),a="".concat(c.restBaseUrl,"/appointments/").concat(e,"/status-change"),[4,(0,c.openmrsFetch)(a,{body:{toStatus:n,onDate:r,timeZone:t},method:"POST",headers:{"Content-Type":"application/json"}})];case 1:return[2,i.sent()]}}))}));var A=function(){var n=d((function(n){return u(this,(function(e){switch(e.label){case 0:return[4,(0,c.openmrsFetch)("".concat(c.restBaseUrl,"/appointments/conflicts"),{method:"POST",body:{patientUuid:n.patientUuid,serviceUuid:n.serviceUuid,startDateTime:n.startDateTime,endDateTime:n.endDateTime,providers:[],locationUuid:n.locationUuid,appointmentKind:n.appointmentKind},headers:{"Content-Type":"application/json"}})];case 1:return[2,e.sent()]}}))}));return function(e){return n.apply(this,arguments)}}()},8527:(n,e,t)=>{"use strict";t.d(e,{W:()=>d,q:()=>f});var r=t(8879),a=t.n(r),o=t(3649),i=t(7234),s=t(6824),l=t.n(s);function c(n,e,t,r,a,o,i){try{var s=n[o](i),l=s.value}catch(n){return void t(n)}s.done?e(l):Promise.resolve(l).then(r,a)}a().extend(l());var p="".concat(i.restBaseUrl,"/appointments/search");function d(n,e,t){var r,s,l,c,d,u,m,f,h,b,v,A=(0,o.ZP)(p,(function(){return(0,i.openmrsFetch)(p,{method:"POST",signal:t.signal,headers:{"Content-Type":"application/json"},body:{patientUuid:n,startDate:e}})})),y=A.data,g=A.error,k=A.isLoading,w=A.isValidating,C=A.mutate,$=(null===(s=y)||void 0===s||null===(r=s.data)||void 0===r?void 0:r.length)?y.data:null,_=null===(d=$)||void 0===d||null===(c=d.sort((function(n,e){return e.startDateTime>n.startDateTime?1:-1})))||void 0===c||null===(l=c.filter((function(n){return"Cancelled"!==n.status})))||void 0===l?void 0:l.filter((function(n){var e=n.startDateTime;return a()(new Date(e).toISOString()).isBefore((new Date).setHours(0,0,0,0))})),T=null===(f=$)||void 0===f||null===(m=f.sort((function(n,e){return n.startDateTime>e.startDateTime?1:-1})))||void 0===m||null===(u=m.filter((function(n){return"Cancelled"!==n.status})))||void 0===u?void 0:u.filter((function(n){var e=n.startDateTime;return a()(new Date(e).toISOString()).isAfter(new Date)})),D=null===(v=$)||void 0===v||null===(b=v.sort((function(n,e){return n.startDateTime>e.startDateTime?1:-1})))||void 0===b||null===(h=b.filter((function(n){return"Cancelled"!==n.status})))||void 0===h?void 0:h.filter((function(n){var e=n.startDateTime;return a()(new Date(e).toISOString()).isToday()}));return{data:y?{pastAppointments:_,upcomingAppointments:T,todaysAppointments:D}:null,error:g,isLoading:k,isValidating:w,mutate:C}}var u,m,f=(u=function(n,e){var t,r,o;return function(n,e){var t,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=e.call(n,i)}catch(n){o=[6,n],r=0}finally{t=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(s){switch(s.label){case 0:return t=Intl.DateTimeFormat().resolvedOptions().timeZone,r=a()(new Date).format("YYYY-MM-DDTHH:mm:ss.SSSZZ"),o="".concat(i.restBaseUrl,"/appointments/").concat(e,"/status-change"),[4,(0,i.openmrsFetch)(o,{body:{toStatus:n,onDate:r,timeZone:t},method:"POST",headers:{"Content-Type":"application/json"}})];case 1:return[2,s.sent()]}}))},m=function(){var n=this,e=arguments;return new Promise((function(t,r){var a=u.apply(n,e);function o(n){c(a,t,r,o,i,"next",n)}function i(n){c(a,t,r,o,i,"throw",n)}o(void 0)}))},function(n,e){return m.apply(this,arguments)})}}]);