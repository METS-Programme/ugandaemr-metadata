"use strict";(globalThis.webpackChunk_openmrs_esm_patient_list_app=globalThis.webpackChunk_openmrs_esm_patient_list_app||[]).push([[716],{7729:(t,e,n)=>{n.d(e,{Z:()=>o});var a=n(272),i=n.n(a),r=n(2609),s=n.n(r)()(i());s.push([t.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-patient-list__add-patient__productiveHeading02___Tg4Ke{font-size:var(--cds-heading-compact-02-font-size, 1rem);font-weight:var(--cds-heading-compact-02-font-weight, 600);line-height:var(--cds-heading-compact-02-line-height, 1.375);letter-spacing:var(--cds-heading-compact-02-letter-spacing, 0)}.-esm-patient-list__add-patient__productiveHeading03___ZLZfS{font-size:var(--cds-heading-03-font-size, 1.25rem);font-weight:var(--cds-heading-03-font-weight, 400);line-height:var(--cds-heading-03-line-height, 1.4);letter-spacing:var(--cds-heading-03-letter-spacing, 0)}.-esm-patient-list__add-patient__productiveHeading04___IJa64{font-size:var(--cds-heading-04-font-size, 1.75rem);font-weight:var(--cds-heading-04-font-weight, 400);line-height:var(--cds-heading-04-line-height, 1.28572);letter-spacing:var(--cds-heading-04-letter-spacing, 0)}.-esm-patient-list__add-patient__bodyLong01___kZia8{font-size:var(--cds-body-01-font-size, 0.875rem);font-weight:var(--cds-body-01-font-weight, 400);line-height:var(--cds-body-01-line-height, 1.42857);letter-spacing:var(--cds-body-01-letter-spacing, 0.16px)}.-esm-patient-list__add-patient__bodyShort01___nA8Cw{font-size:var(--cds-body-compact-01-font-size, 0.875rem);font-weight:var(--cds-body-compact-01-font-weight, 400);line-height:var(--cds-body-compact-01-line-height, 1.28572);letter-spacing:var(--cds-body-compact-01-letter-spacing, 0.16px)}.-esm-patient-list__add-patient__bodyShort02___nmEwy{font-size:var(--cds-body-compact-02-font-size, 1rem);font-weight:var(--cds-body-compact-02-font-weight, 400);line-height:var(--cds-body-compact-02-line-height, 1.375);letter-spacing:var(--cds-body-compact-02-letter-spacing, 0)}.-esm-patient-list__add-patient__text02___LHem6{color:#525252}.-esm-patient-list__add-patient__label01___GtOx4{font-size:var(--cds-label-01-font-size, 0.75rem);font-weight:var(--cds-label-01-font-weight, 400);line-height:var(--cds-label-01-line-height, 1.33333);letter-spacing:var(--cds-label-01-letter-spacing, 0.32px)}.-esm-patient-list__add-patient__modal___o88NP{position:fixed;width:100vw;height:100vh;display:grid;background-color:rgba(0,0,0,.5);z-index:9000;justify-items:center;align-items:center}.-esm-patient-list__add-patient__modalContent___AWM2H{width:100%;background-color:#f4f4f4}.-esm-patient-list__add-patient__modalHeader___C25Zv{margin:1rem}.-esm-patient-list__add-patient__patientListList___hlyTd{padding:0 1rem}.-esm-patient-list__add-patient__checkbox___KWZkw{padding-bottom:.875rem}.-esm-patient-list__add-patient__pagination___qvsDi{width:100%;overflow:hidden}.-esm-patient-list__add-patient__paginationContainer___KJmP9{display:flex;justify-content:space-between;align-items:center;position:relative}.-esm-patient-list__add-patient__itemsCountDisplay___jAW9C{position:absolute;top:0;left:1rem;height:3rem;display:flex;align-items:center;color:#525252}.-esm-patient-list__add-patient__pagination___qvsDi>div:first-child{visibility:hidden;width:0}.-esm-patient-list__add-patient__buttonSet___snp28{display:flex;justify-content:space-between;align-items:flex-start}","",{version:3,sources:["webpack://./../../node_modules/@openmrs/esm-styleguide/src/_vars.scss","webpack://./src/style.scss","webpack://./../../node_modules/@carbon/type/scss/_styles.scss","webpack://./src/add-patient/add-patient.scss"],names:[],mappings:"AAoDA,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CCnDF,6DC81BI,uDAAA,CAAA,0DAAA,CAAA,4DAAA,CAAA,8DAAA,CD11BJ,6DC01BI,kDAAA,CAAA,kDAAA,CAAA,kDAAA,CAAA,sDAAA,CDt1BJ,6DCs1BI,kDAAA,CAAA,kDAAA,CAAA,sDAAA,CAAA,sDAAA,CDl1BJ,oDCk1BI,gDAAA,CAAA,+CAAA,CAAA,mDAAA,CAAA,wDAAA,CD90BJ,qDC80BI,wDAAA,CAAA,uDAAA,CAAA,2DAAA,CAAA,gEAAA,CD10BJ,qDC00BI,oDAAA,CAAA,uDAAA,CAAA,yDAAA,CAAA,2DAAA,CDt0BJ,gDACE,aDxBQ,CC2BV,iDCk0BI,gDAAA,CAAA,gDAAA,CAAA,oDAAA,CAAA,yDAAA,CD9zBJ,+CACE,cAAA,CACA,WAAA,CACA,YAAA,CACA,YAAA,CACA,+BAAA,CACA,YAAA,CACA,oBAAA,CACA,kBAAA,CE1CF,sDACE,UAAA,CACA,wBAAA,CAGF,qDACE,WAAA,CAGF,yDACE,cAAA,CAGF,kDACE,sBAAA,CAGF,oDACE,UAAA,CACA,eAAA,CAGF,6DACE,YAAA,CACA,6BAAA,CACA,kBAAA,CACA,iBAAA,CAGF,2DACE,iBAAA,CACA,KAAA,CACA,SAAA,CACA,WAAA,CACA,YAAA,CACA,kBAAA,CACA,aAAA,CAGF,oEACE,iBAAA,CACA,OAAA,CAGF,mDACE,YAAA,CACA,6BAAA,CACA,sBAAA",sourceRoot:""}]),s.locals={productiveHeading02:"-esm-patient-list__add-patient__productiveHeading02___Tg4Ke",productiveHeading03:"-esm-patient-list__add-patient__productiveHeading03___ZLZfS",productiveHeading04:"-esm-patient-list__add-patient__productiveHeading04___IJa64",bodyLong01:"-esm-patient-list__add-patient__bodyLong01___kZia8",bodyShort01:"-esm-patient-list__add-patient__bodyShort01___nA8Cw",bodyShort02:"-esm-patient-list__add-patient__bodyShort02___nmEwy",text02:"-esm-patient-list__add-patient__text02___LHem6",label01:"-esm-patient-list__add-patient__label01___GtOx4",modal:"-esm-patient-list__add-patient__modal___o88NP",modalContent:"-esm-patient-list__add-patient__modalContent___AWM2H",modalHeader:"-esm-patient-list__add-patient__modalHeader___C25Zv",patientListList:"-esm-patient-list__add-patient__patientListList___hlyTd",checkbox:"-esm-patient-list__add-patient__checkbox___KWZkw",pagination:"-esm-patient-list__add-patient__pagination___qvsDi",paginationContainer:"-esm-patient-list__add-patient__paginationContainer___KJmP9",itemsCountDisplay:"-esm-patient-list__add-patient__itemsCountDisplay___jAW9C",buttonSet:"-esm-patient-list__add-patient__buttonSet___snp28"};const o=s},716:(t,e,n)=>{n.r(e),n.d(e,{default:()=>j,useAddablePatientLists:()=>z});var a=n(268),i=n.n(a),r=n(2779),s=n.n(r),o=n(4924),l=n(3255),c=n(7987),d=n(2870),A=n(2565),_=n(1354),p=n.n(_),u=n(1583),m=n.n(u),f=n(7378),h=n.n(f),C=n(5993),g=n.n(C),y=n(4154),b=n.n(y),v=n(8141),w=n.n(v),D=n(7729),k={};k.styleTagTransform=w(),k.setAttributes=g(),k.insert=h().bind(null,"head"),k.domAPI=m(),k.insertStyleElement=b(),p()(D.Z,k);const E=D.Z&&D.Z.locals?D.Z.locals:void 0;function x(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function S(t,e,n,a,i,r,s){try{var o=t[r](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(a,i)}function B(t){return function(){var e=this,n=arguments;return new Promise((function(a,i){var r=t.apply(e,n);function s(t){S(r,a,i,s,o,"next",t)}function o(t){S(r,a,i,s,o,"throw",t)}s(void 0)}))}}function L(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var a,i,r=[],s=!0,o=!1;try{for(n=n.call(t);!(s=(a=n.next()).done)&&(r.push(a.value),!e||r.length!==e);s=!0);}catch(t){o=!0,i=t}finally{try{s||null==n.return||n.return()}finally{if(o)throw i}}return r}}(t,e)||N(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(t){return function(t){if(Array.isArray(t))return x(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||N(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(t,e){if(t){if("string"==typeof t)return x(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?x(t,e):void 0}}var P=function(t,e){var n,a,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(r){return function(o){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,a=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,o])}}};function z(t){var e=(0,o.useTranslation)().t,n=(0,d.useConfig)();return(0,l.ZP)(["addablePatientLists",t],B((function(){var a,i,r;return P(this,(function(s){switch(s.label){case 0:return[4,Promise.allSettled([J(t,e),I(t,n.myListCohortTypeUUID,n.systemListCohortTypeUUID)])];case 1:return a=L.apply(void 0,[s.sent(),2]),i=a[0],r=a[1],[2,T("fulfilled"===i.status?i.value:[]).concat(T("fulfilled"===r.status?r.value:[]))]}}))})))}function I(t,e,n){return H.apply(this,arguments)}function H(){return(H=B((function(t,e,n){var a,i,r;return P(this,(function(s){switch(s.label){case 0:return[4,Promise.all([(0,A.SA)({},e,n),(0,A.U6)(t)])];case 1:return a=L.apply(void 0,[s.sent(),2]),i=a[0],r=a[1],[2,i.map((function(e){return{id:e.id,displayName:e.display,checked:r.includes(e.id),addPatient:function(){return B((function(){return P(this,(function(n){switch(n.label){case 0:return[4,(0,A.xj)({cohort:e.id,patient:t,startDate:(0,d.toOmrsIsoString)(new Date)})];case 1:return n.sent(),[2]}}))}))()}}}))]}}))}))).apply(this,arguments)}function J(t,e){return Z.apply(this,arguments)}function Z(){return(Z=B((function(t,e){return P(this,(function(n){switch(n.label){case 0:return[4,(0,d.getDynamicOfflineDataEntries)("patient")];case 1:return[2,n.sent().some((function(e){return e.identifier===t}))?[]:[{id:"fake-offline-patient-list",displayName:e("offlinePatients","Offline patients"),addPatient:function(){return B((function(){return P(this,(function(e){switch(e.label){case 0:return[4,(0,d.putDynamicOfflineData)("patient",t)];case 1:return e.sent(),[4,(0,d.syncDynamicOfflineData)("patient",t)];case 2:return e.sent(),[2]}}))}))()}}]]}}))}))).apply(this,arguments)}const j=function(t){var e=t.closeModal,n=t.patientUuid,r=(0,o.useTranslation)().t,l=L((0,a.useState)(""),2),A=l[0],_=l[1],p=L((0,a.useState)([]),2),u=p[0],m=p[1],f=z(n),h=f.data,C=f.isLoading,g=(0,a.useCallback)((function(t,e){m(e?function(e){return T(e).concat([t])}:function(e){return e.filter((function(e){return e!==t}))})}),[]),y=(0,a.useCallback)((function(){var t=!0,n=!1,a=void 0;try{for(var i,s=function(){var t=i.value,e=h.find((function(e){return e.id===t}));if(!e)return"continue";e.addPatient().then((function(){return(0,d.showToast)({title:r("successfullyAdded","Successfully added"),kind:"success",description:"".concat(r("successAddPatientToList","Patient added to list"),": ").concat(e.displayName)})})).catch((function(){return(0,d.showToast)({title:r("error","Error"),kind:"error",description:"".concat(r("errorAddPatientToList","Patient not added to list"),": ").concat(e.displayName)})}))},o=u[Symbol.iterator]();!(t=(i=o.next()).done);t=!0)s()}catch(t){n=!0,a=t}finally{try{t||null==o.return||o.return()}finally{if(n)throw a}}e()}),[h,u,e,r]),b=(0,a.useMemo)((function(){if(!h)return[];if((null==A?void 0:A.trim().length)>0){var t=A.toLowerCase();return h.filter((function(e){return e.displayName.toLowerCase().includes(t)}))}return h}),[A,h]),v=(0,d.usePagination)(b,5),w=v.results,D=v.goTo,k=v.currentPage,x=v.paginated;return(0,a.useEffect)((function(){1!==k&&D(1)}),[A]),i().createElement("div",{className:E.modalContent},i().createElement("div",{className:E.modalHeader},i().createElement("h1",{className:E.productiveHeading03},r("addPatientToList","Add patient to list")),i().createElement("h3",{className:E.bodyLong01,style:{margin:"1rem 0"}},r("searchForAListToAddThisPatientTo","Search for a list to add this patient to."))),i().createElement("div",{style:{marginBottom:"0.875rem"}},i().createElement(c.olm,{style:{backgroundColor:"white",borderBottom:"1px solid #e0e0e0"},labelText:r("searchForList","Search for a list"),placeholder:"Filter list",onChange:function(t){var e=t.target;_(e.value)},value:A})),i().createElement("div",{className:E.patientListList},i().createElement("fieldset",{className:"cds--fieldset"},i().createElement("p",{className:"cds--label"},r("patientLists","Patient lists")),!C&&w?w.length>0?w.map((function(t){return i().createElement("div",{key:t.id,className:E.checkbox},i().createElement(c.XZJ,{key:t.id,onChange:function(e){return g(t.id,e.target.checked)},checked:t.checked||u.includes(t.id),disabled:t.checked,labelText:t.displayName,id:t.id}))})):i().createElement("p",{className:E.bodyLong01},r("noPatientListFound","No patient list found")):i().createElement(i().Fragment,null,i().createElement("div",{className:E.checkbox},i().createElement(c.jJq,null)),i().createElement("div",{className:E.checkbox},i().createElement(c.jJq,null)),i().createElement("div",{className:E.checkbox},i().createElement(c.jJq,null)),i().createElement("div",{className:E.checkbox},i().createElement(c.jJq,null)),i().createElement("div",{className:E.checkbox},i().createElement(c.jJq,null))))),x&&i().createElement("div",{className:E.paginationContainer},i().createElement("span",{className:s()(E.itemsCountDisplay,E.bodyLong01)},w.length*k," / ",b.length," ",r("items","items")),i().createElement(c.tlE,{className:E.pagination,forwardText:"",backwardText:"",page:k,pageSize:5,pageSizes:[5],totalItems:b.length,onChange:function(t){var e=t.page;return D(e)}})),i().createElement("div",{className:E.buttonSet},i().createElement(c.zxk,{kind:"ghost",size:"xl",onClick:function(){(0,d.navigate)({to:window.getOpenmrsSpaBase()+"home/patient-lists?new_cohort=true"}),e()}},r("createNewPatientList","Create new patient list")),i().createElement("div",null,i().createElement(c.zxk,{kind:"secondary",size:"xl",onClick:e},r("cancel","Cancel")),i().createElement(c.zxk,{onClick:y,size:"xl"},r("addToList","Add to list")))))}}}]);