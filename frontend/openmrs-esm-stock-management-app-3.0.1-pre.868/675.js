"use strict";(globalThis.webpackChunk_openmrs_esm_stock_management_app=globalThis.webpackChunk_openmrs_esm_stock_management_app||[]).push([[675],{3377:(e,n,t)=>{t.d(n,{Z:()=>c});var a=t(1364),l=t.n(a),o=t(1682),r=t.n(o)()(l());r.push([e.id,".-esm-stock-management__add-stock-rules__formContainer___LOhSA{display:flex;flex-direction:column;justify-content:space-between;width:100%;height:100%;padding:.5rem}.-esm-stock-management__add-stock-rules__button___vnK9P{height:4rem;display:flex;align-content:flex-start;align-items:baseline;min-width:50%}.-esm-stock-management__add-stock-rules__buttonSet___rvyIi{display:flex;justify-content:space-between;width:100%}","",{version:3,sources:["webpack://./src/stock-items/add-stock-item/stock-item-rules/add-stock-rules.scss","webpack://./node_modules/@carbon/layout/scss/generated/_spacing.scss"],names:[],mappings:"AAIA,+DACE,YAAA,CACA,qBAAA,CACA,6BAAA,CACA,UAAA,CACA,WAAA,CACA,aCWW,CDRb,wDACE,WC0CW,CDzCX,YAAA,CACA,wBAAA,CACA,oBAAA,CACA,aAAA,CAGF,2DACE,YAAA,CACA,6BAAA,CACA,UAAA",sourcesContent:["@use '@carbon/type';\n@use '@carbon/layout';\n@use '@carbon/colors';\n\n.formContainer {\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  width: 100%;\n  height: 100%;\n  padding: layout.$spacing-03;\n}\n\n.button {\n  height: layout.$spacing-10;\n  display: flex;\n  align-content: flex-start;\n  align-items: baseline;\n  min-width: 50%;\n}\n\n.buttonSet {\n  display: flex;\n  justify-content: space-between;\n  width: 100%;\n}\n","// Code generated by @carbon/layout. DO NOT EDIT.\n//\n// Copyright IBM Corp. 2018, 2023\n//\n// This source code is licensed under the Apache-2.0 license found in the\n// LICENSE file in the root directory of this source tree.\n//\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-01: 0.125rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-02: 0.25rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-03: 0.5rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-04: 0.75rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-05: 1rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-06: 1.5rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-07: 2rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-08: 2.5rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-09: 3rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-10: 4rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-11: 5rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-12: 6rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-13: 10rem !default;\n\n/// @type Map\n/// @access public\n/// @group @carbon/layout\n$spacing: (\n  spacing-01: $spacing-01,\n  spacing-02: $spacing-02,\n  spacing-03: $spacing-03,\n  spacing-04: $spacing-04,\n  spacing-05: $spacing-05,\n  spacing-06: $spacing-06,\n  spacing-07: $spacing-07,\n  spacing-08: $spacing-08,\n  spacing-09: $spacing-09,\n  spacing-10: $spacing-10,\n  spacing-11: $spacing-11,\n  spacing-12: $spacing-12,\n  spacing-13: $spacing-13,\n);\n"],sourceRoot:""}]),r.locals={formContainer:"-esm-stock-management__add-stock-rules__formContainer___LOhSA",button:"-esm-stock-management__add-stock-rules__button___vnK9P",buttonSet:"-esm-stock-management__add-stock-rules__buttonSet___rvyIi"};const c=r},5675:(e,n,t)=>{t.r(n),t.d(n,{default:()=>R});var a=t(1672),l=t.n(a),o=t(3967),r=t.n(o),c=t(3397),i=t(5787),s=t(3775),u=t(2400),d=t(2484),m=t(3566),p=t(3889),b=t(7410),g=t.n(b),y=t(4766),f=t.n(y),h=t(1991),v=t.n(h),A=t(3702),C=t.n(A),k=t(2434),_=t.n(k),E=t(1422),w=t.n(E),O=t(3377),N={};N.styleTagTransform=w(),N.setAttributes=C(),N.insert=v().bind(null,"head"),N.domAPI=f(),N.insertStyleElement=_(),g()(O.Z,N);const x=O.Z&&O.Z.locals?O.Z.locals:void 0;function j(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}function T(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function S(){return S=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},S.apply(this,arguments)}function $(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},a=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),a.forEach((function(n){T(e,n,t[n])}))}return e}function P(e,n){return n=null!=n?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):function(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t.push.apply(t,a)}return t}(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})),e}function F(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var a,l,o=[],r=!0,c=!1;try{for(t=t.call(e);!(r=(a=t.next()).done)&&(o.push(a.value),!n||o.length!==n);r=!0);}catch(e){c=!0,l=e}finally{try{r||null==t.return||t.return()}finally{if(c)throw l}}return o}}(e,n)||function(e,n){if(e){if("string"==typeof e)return j(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?j(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const R=function(e){var n,t,o,b=e.model,g=e.stockItemUuid,y=e.closeWorkspace,f=(0,c.useTranslation)().t,h="tablet"===(0,s.useLayoutType)(),v=F((0,a.useState)({startIndex:0,v:d._.Default,q:null,totalCount:!0}),2),A=v[0],C=v[1];(0,a.useEffect)((function(){C({startIndex:0,v:d._.Default,totalCount:!0,stockItemUuid:g})}),[g]);var k=(0,m.Yf)(A).items,_=(0,p.O8)().stockLocations,E=(0,p.dc)({v:d._.Default}).items,w=F((0,a.useState)($({enabled:!0},b)),2),O=w[0],N=w[1];(0,a.useEffect)((function(){if(null!=b&&0!=Object.keys(b).length){var e=$({},S({},function(e){if(null==e)throw new TypeError("Cannot destructure "+e);return e}(b)));N(e)}}),[b]);var j,R=(0,a.useCallback)((function(e){e.preventDefault(),b&&(O.uuid=b.uuid),g&&(O.stockItemUuid=g),(0,u.eD)(O).then((function(){(0,s.showSnackbar)({isLowContrast:!0,title:f("addedRule","Add Rule"),kind:"success",subtitle:f("stockRuleAddedSuccessfully","Stock Rule Added Successfully")}),null==y||y()}),(function(e){(0,s.showSnackbar)({title:f("errorAddingRule","Error adding a rule"),kind:"error",isLowContrast:!0,subtitle:null==e?void 0:e.message})})).catch()}),[O,b,f,g,y]);return l().createElement(i.l09,{onSubmit:R,className:x.formContainer},l().createElement("div",null,l().createElement(i.cwH,null,l().createElement("section",{className:x.section},l().createElement("section",{className:x.section},l().createElement(i.PhF,{name:"location",className:"select-field",labelText:f("location","Location"),id:"location",value:(null==O?void 0:O.locationUuid)?O.locationUuid:"",onChange:function(e){var n=_.find((function(n){return n.id===e.target.value}));N(P($({},O),{locationUuid:n.id}))}},l().createElement(i.QlF,{disabled:!0,hidden:!0,value:"",text:f("chooseLocation","Choose the location")}),null==_?void 0:_.map((function(e){return l().createElement(i.QlF,{key:e.id,value:e.id,text:e.name})})))),l().createElement("section",{className:x.section},l().createElement(i.oil,{id:"name",type:"text",labelText:f("name","Rule Name"),size:"md",onChange:function(e){b&&(b.name=e.target.value),N(P($({},O),{name:e.target.value}))},value:null==b?void 0:b.name,placeholder:"e.g Panado Alert"})),l().createElement("section",{className:x.section},l().createElement(i.PhF,{name:"quantityUnit",className:"select-field",labelText:f("quantityUnit","Quantity Unit"),id:"quantityUnit",value:(null==O?void 0:O.stockItemPackagingUOMUuid)?O.stockItemPackagingUOMUuid:"",onChange:function(e){var n=null==k?void 0:k.results.find((function(n){return n.uuid===e.target.value}));N(P($({},O),{stockItemPackagingUOMUuid:null==n?void 0:n.uuid}))}},l().createElement(i.QlF,{disabled:!0,hidden:!0,value:"",text:f("chooseQuantityUnit","Choose the Unit of Quantity")}),null==k||null===(n=k.results)||void 0===n?void 0:n.map((function(e){return l().createElement(i.QlF,{key:e.uuid,value:e.uuid,text:e.packagingUomName})})))),l().createElement("section",{className:x.section},l().createElement(i.oil,{id:"quantity",type:"number",labelText:f("quantity","Quantity Threshold"),size:"md",onChange:function(e){b&&(b.quantity=Number(e.target.value)),N(P($({},O),{quantity:Number(e.target.value)}))},value:null==b?void 0:b.quantity,placeholder:"e.g 30 Boxes"})))),l().createElement(i.cwH,null,l().createElement("section",{className:x.section},l().createElement(i.PhF,{name:"alertRole",className:"select-field",labelText:f("alertRole","Alert Role"),id:"alertRole",value:(null==O?void 0:O.alertRole)?O.alertRole:"",onChange:function(e){var n=null==E?void 0:E.results.find((function(n){return n.display===e.target.value}));N(P($({},O),{alertRole:n.display}))}},l().createElement(i.QlF,{disabled:!0,hidden:!0,value:"",text:f("chooseAlertRole","Choose an Alert Role")}),null==E||null===(t=E.results)||void 0===t?void 0:t.map((function(e){return l().createElement(i.QlF,{key:e.display,value:e.display,text:e.display})})))),l().createElement("section",{className:x.section},l().createElement(i.PhF,{name:"mailRole",className:"select-field",labelText:f("mailRole","Mail Role"),id:"mailRole",value:(null==O?void 0:O.mailRole)?O.mailRole:"",onChange:function(e){var n=null==E?void 0:E.results.find((function(n){return n.display===e.target.value}));console.warn("Setting mail role to: ",n),N(P($({},O),{mailRole:n.display}))}},l().createElement(i.QlF,{disabled:!0,hidden:!0,value:"",text:f("chooseMailRole","Choose a Mail Role")}),null==E||null===(o=E.results)||void 0===o?void 0:o.map((function(e){return l().createElement(i.QlF,{key:e.display,value:e.display,text:e.display})})))),l().createElement("section",{className:x.section},l().createElement(i.oil,{id:"evaluationFrequency",type:"number",labelText:f("evaluationFrequency","Frequency Check (Minutes)"),size:"md",onChange:function(e){b&&(b.evaluationFrequency=Number(e.target.value)),N(P($({},O),{evaluationFrequency:Number(e.target.value)}))},value:null==b?void 0:b.evaluationFrequency,placeholder:"e.g 30 Minutes"}),l().createElement(i.oil,{id:"actionFrequency",type:"number",labelText:f("actionFrequency","Notification Frequency (Minutes)"),size:"md",onChange:function(e){b&&(b.actionFrequency=Number(e.target.value)),N(P($({},O),{actionFrequency:Number(e.target.value)}))},value:null==b?void 0:b.actionFrequency,placeholder:"e.g 3600 Minutes"}))),l().createElement("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",justifyContent:"center"}},l().createElement(i.cwH,{className:"clear-margin-bottom"},l().createElement(i.cOn,{className:x.checkboxGrid},l().createElement(i.XZJ,{onChange:function(){var e=!(null==O?void 0:O.enabled);N(P($({},O),{enabled:e}))},checked:null==O?void 0:O.enabled,labelText:"Enabled ?",value:null==b?void 0:b.enabled,id:"chk-ruleEnabled"}))),l().createElement(i.cwH,{className:"clear-margin-bottom"},l().createElement(i.cOn,{className:x.checkboxGrid},l().createElement(i.XZJ,{onChange:function(){var e=!(null==O?void 0:O.enableDescendants);N(P($({},O),{enableDescendants:e}))},name:"appliesToChildren",checked:null==O?void 0:O.enableDescendants,value:null==b?void 0:b.enableDescendants,labelText:"Applies to child locations?",id:"chk-ruleAppliesToChildren"})))),l().createElement("div",null,"This stock rule will be evaluated by checking if the stock quantities have lowered to the threshold or below and a notification will be sent to the personnel with the specified role in the given location. The notification will only be sent once per specified notification frequency.")),l().createElement(i.uVA,{className:r()(x.buttonSet,(j={},T(j,x.tablet,h),T(j,x.desktop,!h),j))},l().createElement(i.zxk,{kind:"secondary",onClick:y,className:x.button},(0,s.getCoreTranslation)("cancel")),l().createElement(i.zxk,{type:"submit",className:x.button},(0,s.getCoreTranslation)("save"))))}},2400:(e,n,t)=>{t.d(n,{eD:()=>s,yf:()=>i});var a=t(3775),l=t(2484),o=t(5494);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function c(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},a=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),a.forEach((function(n){r(e,n,t[n])}))}return e}function i(e){var n="".concat(a.restBaseUrl,"/stockmanagement/stockrule").concat((0,l.m)(e)),t=(0,o.ZP)(n,a.openmrsFetch),r=t.data,c=t.error,i=t.isLoading;return{items:(null==r?void 0:r.data)||{},isLoading:i,error:c}}function s(e){var n=null!=e.uuid,t="".concat(a.restBaseUrl,"/stockmanagement/stockrule").concat(n?"/"+e.uuid:""),l=new AbortController;return(0,a.openmrsFetch)(t,{method:"POST",headers:{"Content-Type":"application/json"},signal:l.signal,body:c({},e)})}}}]);