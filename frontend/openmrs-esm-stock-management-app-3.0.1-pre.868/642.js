"use strict";(globalThis.webpackChunk_openmrs_esm_stock_management_app=globalThis.webpackChunk_openmrs_esm_stock_management_app||[]).push([[642],{2285:(e,n,t)=>{t.d(n,{Z:()=>l});var r=t(1364),a=t.n(r),o=t(1682),i=t.n(o)()(a());i.push([e.id,".-esm-stock-management__add-stock-item__formContainer___nmKqB{display:flex;flex-direction:column;justify-content:space-between;width:100%;height:100%}.-esm-stock-management__add-stock-item__button___tK5rU{height:4rem;display:flex;align-content:flex-start;align-items:baseline;min-width:50%}.-esm-stock-management__add-stock-item__buttonSet___0MA8x{display:flex;justify-content:space-between;width:100%}.-esm-stock-management__add-stock-item__stack___nRI14{margin:1rem}","",{version:3,sources:["webpack://./src/stock-items/add-stock-item/add-stock-item.scss","webpack://./node_modules/@carbon/layout/scss/generated/_spacing.scss"],names:[],mappings:"AAIA,8DACE,YAAA,CACA,qBAAA,CACA,6BAAA,CACA,UAAA,CACA,WAAA,CAGF,uDACE,WC2CW,CD1CX,YAAA,CACA,wBAAA,CACA,oBAAA,CACA,aAAA,CAGF,0DACE,YAAA,CACA,6BAAA,CACA,UAAA,CAGF,sDACE,WCIW",sourcesContent:["@use '@carbon/type';\n@use '@carbon/layout';\n@use '@carbon/colors';\n\n.formContainer {\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  width: 100%;\n  height: 100%;\n}\n\n.button {\n  height: layout.$spacing-10;\n  display: flex;\n  align-content: flex-start;\n  align-items: baseline;\n  min-width: 50%;\n}\n\n.buttonSet {\n  display: flex;\n  justify-content: space-between;\n  width: 100%;\n}\n\n.stack {\n  margin: layout.$spacing-05;\n}\n","// Code generated by @carbon/layout. DO NOT EDIT.\n//\n// Copyright IBM Corp. 2018, 2023\n//\n// This source code is licensed under the Apache-2.0 license found in the\n// LICENSE file in the root directory of this source tree.\n//\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-01: 0.125rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-02: 0.25rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-03: 0.5rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-04: 0.75rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-05: 1rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-06: 1.5rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-07: 2rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-08: 2.5rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-09: 3rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-10: 4rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-11: 5rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-12: 6rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-13: 10rem !default;\n\n/// @type Map\n/// @access public\n/// @group @carbon/layout\n$spacing: (\n  spacing-01: $spacing-01,\n  spacing-02: $spacing-02,\n  spacing-03: $spacing-03,\n  spacing-04: $spacing-04,\n  spacing-05: $spacing-05,\n  spacing-06: $spacing-06,\n  spacing-07: $spacing-07,\n  spacing-08: $spacing-08,\n  spacing-09: $spacing-09,\n  spacing-10: $spacing-10,\n  spacing-11: $spacing-11,\n  spacing-12: $spacing-12,\n  spacing-13: $spacing-13,\n);\n"],sourceRoot:""}]),i.locals={formContainer:"-esm-stock-management__add-stock-item__formContainer___nmKqB",button:"-esm-stock-management__add-stock-item__button___tK5rU",buttonSet:"-esm-stock-management__add-stock-item__buttonSet___0MA8x",stack:"-esm-stock-management__add-stock-item__stack___nRI14"};const l=i},7179:(e,n,t)=>{t.d(n,{Z:()=>l});var r=t(1364),a=t.n(r),o=t(1682),i=t.n(o)()(a());i.push([e.id,".-esm-stock-management__packaging-units__packingTable___EPbfh{min-height:15rem;display:block}.-esm-stock-management__packaging-units__packingTableCell___VOei6{display:flex;align-items:center}.-esm-stock-management__packaging-units__packagingTableBody___1G5i-{min-height:10rem}.-esm-stock-management__packaging-units__packagingTableContainer___8\\+wOb{padding-bottom:1rem;min-height:15rem;display:block}.-esm-stock-management__packaging-units__packagingTableContainer___8\\+wOb .cds--data-table-content{overflow-x:visible}.-esm-stock-management__packaging-units__searchAndSave___dxJ\\+N{display:flex;flex-direction:column;align-items:flex-start}.-esm-stock-management__packaging-units__searchAndSave___dxJ\\+N .-esm-stock-management__packaging-units__submitButton___sVB-U{margin-top:1rem}.-esm-stock-management__packaging-units__deleteModal___laBsG .cds--modal-container.cds--modal-container--sm .cds--modal-content .cds--form-item{margin-top:1rem}.-esm-stock-management__packaging-units__packageUnitsBtn___2i\\+HC{display:flex;justify-content:flex-end;margin-right:2rem}cds--form-item{margin-top:1rem}","",{version:3,sources:["webpack://./src/stock-items/add-stock-item/packaging-units/packaging-units.scss","webpack://./node_modules/@carbon/layout/scss/generated/_spacing.scss"],names:[],mappings:"AAIA,8DACE,gBAAA,CACA,aAAA,CAGF,kEACE,YAAA,CACA,kBAAA,CAGF,oEACE,gBCwDW,CDrDb,0EACE,mBAAA,CACA,gBAAA,CACA,aAAA,CAEA,mGACE,kBAAA,CAIJ,gEACE,YAAA,CACA,qBAAA,CACA,sBAAA,CACA,8HACE,eAAA,CAOE,gJACE,eAAA,CAMR,kEACE,YAAA,CACA,wBAAA,CACA,iBAAA,CAGF,eACE,eAAA",sourcesContent:["@use '@carbon/colors';\n@use '@carbon/layout';\n@use '@carbon/type';\n\n.packingTable {\n  min-height: 15rem;\n  display: block;\n}\n\n.packingTableCell {\n  display: flex;\n  align-items: center;\n}\n\n.packagingTableBody {\n  min-height: layout.$spacing-13;\n}\n\n.packagingTableContainer {\n  padding-bottom: 1rem;\n  min-height: 15rem;\n  display: block;\n\n  :global(.cds--data-table-content) {\n    overflow-x: visible;\n  }\n}\n\n.searchAndSave {\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  .submitButton {\n    margin-top: 1rem;\n  }\n}\n\n.deleteModal {\n  :global(.cds--modal-container.cds--modal-container--sm) {\n    :global(.cds--modal-content) {\n      :global(.cds--form-item) {\n        margin-top: 1rem;\n      }\n    }\n  }\n}\n\n.packageUnitsBtn {\n  display: flex;\n  justify-content: flex-end;\n  margin-right: 2rem;\n}\n\n:global(cds--form-item) {\n  margin-top: 1rem;\n}\n","// Code generated by @carbon/layout. DO NOT EDIT.\n//\n// Copyright IBM Corp. 2018, 2023\n//\n// This source code is licensed under the Apache-2.0 license found in the\n// LICENSE file in the root directory of this source tree.\n//\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-01: 0.125rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-02: 0.25rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-03: 0.5rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-04: 0.75rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-05: 1rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-06: 1.5rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-07: 2rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-08: 2.5rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-09: 3rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-10: 4rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-11: 5rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-12: 6rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-13: 10rem !default;\n\n/// @type Map\n/// @access public\n/// @group @carbon/layout\n$spacing: (\n  spacing-01: $spacing-01,\n  spacing-02: $spacing-02,\n  spacing-03: $spacing-03,\n  spacing-04: $spacing-04,\n  spacing-05: $spacing-05,\n  spacing-06: $spacing-06,\n  spacing-07: $spacing-07,\n  spacing-08: $spacing-08,\n  spacing-09: $spacing-09,\n  spacing-10: $spacing-10,\n  spacing-11: $spacing-11,\n  spacing-12: $spacing-12,\n  spacing-13: $spacing-13,\n);\n"],sourceRoot:""}]),i.locals={packingTable:"-esm-stock-management__packaging-units__packingTable___EPbfh",packingTableCell:"-esm-stock-management__packaging-units__packingTableCell___VOei6",packagingTableBody:"-esm-stock-management__packaging-units__packagingTableBody___1G5i-",packagingTableContainer:"-esm-stock-management__packaging-units__packagingTableContainer___8+wOb",searchAndSave:"-esm-stock-management__packaging-units__searchAndSave___dxJ+N",submitButton:"-esm-stock-management__packaging-units__submitButton___sVB-U",deleteModal:"-esm-stock-management__packaging-units__deleteModal___laBsG",packageUnitsBtn:"-esm-stock-management__packaging-units__packageUnitsBtn___2i+HC"};const l=i},1326:(e,n,t)=>{t.d(n,{Z:()=>l});var r=t(1364),a=t.n(r),o=t(1682),i=t.n(o)()(a());i.push([e.id,".-esm-stock-management__stock-item-references__referencesTable___EE97v{min-height:15rem;display:block}.-esm-stock-management__stock-item-references__referencesTableCell___wKQMa{display:flex;align-items:center}.-esm-stock-management__stock-item-references__referencesTableBody___sAxJs{min-height:10rem}.-esm-stock-management__stock-item-references__referencesTableContainer___ryYba{min-height:15rem;display:block}","",{version:3,sources:["webpack://./src/stock-items/add-stock-item/stock-item-references/stock-item-references.scss","webpack://./node_modules/@carbon/layout/scss/generated/_spacing.scss"],names:[],mappings:"AAIA,uEACE,gBAAA,CACA,aAAA,CAGF,2EACE,YAAA,CACA,kBAAA,CAGF,2EACE,gBCwDW,CDrDb,gFACE,gBAAA,CACA,aAAA",sourcesContent:["@use '@carbon/colors';\n@use '@carbon/layout';\n@use '@carbon/type';\n\n.referencesTable {\n  min-height: 15rem;\n  display: block;\n}\n\n.referencesTableCell {\n  display: flex;\n  align-items: center;\n}\n\n.referencesTableBody {\n  min-height: layout.$spacing-13;\n}\n\n.referencesTableContainer {\n  min-height: 15rem;\n  display: block;\n}\n","// Code generated by @carbon/layout. DO NOT EDIT.\n//\n// Copyright IBM Corp. 2018, 2023\n//\n// This source code is licensed under the Apache-2.0 license found in the\n// LICENSE file in the root directory of this source tree.\n//\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-01: 0.125rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-02: 0.25rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-03: 0.5rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-04: 0.75rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-05: 1rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-06: 1.5rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-07: 2rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-08: 2.5rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-09: 3rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-10: 4rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-11: 5rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-12: 6rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-13: 10rem !default;\n\n/// @type Map\n/// @access public\n/// @group @carbon/layout\n$spacing: (\n  spacing-01: $spacing-01,\n  spacing-02: $spacing-02,\n  spacing-03: $spacing-03,\n  spacing-04: $spacing-04,\n  spacing-05: $spacing-05,\n  spacing-06: $spacing-06,\n  spacing-07: $spacing-07,\n  spacing-08: $spacing-08,\n  spacing-09: $spacing-09,\n  spacing-10: $spacing-10,\n  spacing-11: $spacing-11,\n  spacing-12: $spacing-12,\n  spacing-13: $spacing-13,\n);\n"],sourceRoot:""}]),i.locals={referencesTable:"-esm-stock-management__stock-item-references__referencesTable___EE97v",referencesTableCell:"-esm-stock-management__stock-item-references__referencesTableCell___wKQMa",referencesTableBody:"-esm-stock-management__stock-item-references__referencesTableBody___sAxJs",referencesTableContainer:"-esm-stock-management__stock-item-references__referencesTableContainer___ryYba"};const l=i},2916:(e,n,t)=>{t.d(n,{Z:()=>l});var r=t(1364),a=t.n(r),o=t(1682),i=t.n(o)()(a());i.push([e.id,".-esm-stock-management__stock-rules-filter__filterContainer___bIER5 .cds--dropdown__wrapper--inline{gap:0}.-esm-stock-management__stock-rules-filter__filterContainer___bIER5 .cds--list-box__menu-icon{height:1rem}.-esm-stock-management__stock-rules-filter__filterContainer___bIER5 .cds--dropdown--inline .cds--list-box__field{min-width:12rem}","",{version:3,sources:["webpack://./src/stock-items/add-stock-item/stock-item-rules/stock-rules-filter.scss"],names:[],mappings:"AACE,oGACE,KAAA,CAGF,8FACE,WAAA,CAGF,iHACE,eAAA",sourcesContent:[".filterContainer {\n  :global(.cds--dropdown__wrapper--inline) {\n    gap: 0;\n  }\n\n  :global(.cds--list-box__menu-icon) {\n    height: 1rem;\n  }\n\n  :global(.cds--dropdown--inline) :global(.cds--list-box__field) {\n    min-width: 12rem;\n  }\n}\n"],sourceRoot:""}]),i.locals={filterContainer:"-esm-stock-management__stock-rules-filter__filterContainer___bIER5"};const l=i},3440:(e,n,t)=>{t.d(n,{Z:()=>v});var r=t(7410),a=t.n(r),o=t(4766),i=t.n(o),l=t(1991),c=t.n(l),u=t(3702),s=t.n(u),d=t(2434),m=t.n(d),p=t(1422),g=t.n(p),f=t(7179),y={};y.styleTagTransform=g(),y.setAttributes=s(),y.insert=c().bind(null,"head"),y.domAPI=i(),y.insertStyleElement=m(),a()(f.Z,y);const v=f.Z&&f.Z.locals?f.Z.locals:void 0},9642:(e,n,t)=>{t.r(n),t.d(n,{default:()=>Dn});var r=t(1672),a=t.n(r),o=t(3397),i=t(9937),l=t(5787),c=t(6946),u=t(6066),s=t(7536),d=t(3889);const m=function(e){var n=(0,o.useTranslation)().t,t=(0,d.O8)().stockLocations;return a().createElement(s.Qr,{name:e.controllerName,control:e.control,render:function(r){var o,i=r.field,c=i.onChange,u=i.value,s=i.ref;return a().createElement(l.CtY,{titleText:e.title,name:e.name,control:e.control,controllerName:e.controllerName,id:e.name,size:"md",items:null!=t?t:[],onChange:function(n){var t,r,a,o;null===(r=e.onLocationIdChange)||void 0===r||r.call(e,null!==(o=null==n||null===(t=n.selectedItem)||void 0===t?void 0:t.id)&&void 0!==o?o:""),c((null==n||null===(a=n.selectedItem)||void 0===a?void 0:a.name)||"")},initialSelectedItem:"".concat(null===(o=t[0])||void 0===o?void 0:o.name),itemToString:function(e){return n("location","".concat(null==e?void 0:e.name))},shouldFilterItem:function(){return!0},placeholder:e.placeholder,ref:s,value:u,invalid:e.invalid,invalidText:e.invalidText})}})};function p(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function g(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function f(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){g(e,n,t[n])}))}return e}function y(e,n){return n=null!=n?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):function(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})),e}const v=function(e){var n,t,d=e.stockItemUuid,g=(n=(0,r.useState)(),t=2,function(e){if(Array.isArray(e))return e}(n)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,o=[],i=!0,l=!1;try{for(t=t.call(e);!(i=(r=t.next()).done)&&(o.push(r.value),!n||o.length!==n);i=!0);}catch(e){l=!0,a=e}finally{try{i||null==t.return||t.return()}finally{if(l)throw a}}return o}}(n,t)||function(e,n){if(e){if("string"==typeof e)return p(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?p(e,n):void 0}}(n,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),v=g[0],b=g[1],h=(0,u.b)(v),k=h.isLoading,U=h.items,A=h.totalCount,S=h.setCurrentPage,C=h.setStockItemUuid,E=h.setLocationUuid,_=(0,o.useTranslation)().t,w=(0,s.cI)({}).control;(0,r.useEffect)((function(){C(d)}),[d,C]);var O=(0,r.useMemo)((function(){return[{key:"location",header:_("location","Location")},{key:"batch",header:_("batchNumber","Batch Number")},{key:"quantity",header:_("quantity","Quantity")},{key:"packaging",header:_("packagingUnit","Packaging Unit")},{key:"expires",header:_("expires","Expires")}]}),[_]),I=(0,r.useMemo)((function(){return null==U?void 0:U.map((function(e,n){var t,r,a,o,l;return y(f({},e),{id:"".concat(e.partyUuid).concat(e.stockBatchUuid).concat(n),key:"".concat(e.partyUuid).concat(e.stockBatchUuid).concat(n),uuid:"".concat(e.partyUuid).concat(e.stockBatchUuid).concat(n),expires:(0,i.up)(null==e?void 0:e.expiration),location:null==e?void 0:e.partyName,quantity:null!==(r=null==e||null===(t=e.quantity)||void 0===t?void 0:t.toLocaleString())&&void 0!==r?r:"",batch:null!==(a=e.batchNumber)&&void 0!==a?a:"",packaging:"".concat(null!==(o=e.quantityUoM)&&void 0!==o?o:""," of ").concat(null!==(l=e.quantityFactor)&&void 0!==l?l:"")})}))}),[U]);return k?a().createElement(l.gqd,{role:"progressbar"}):a().createElement(c.Z,{children:function(){return a().createElement(a().Fragment,null,a().createElement(m,{control:w,onLocationIdChange:function(e){E(e),b(y(f({},v),{locationUuid:e}))},placeholder:_("filterByLocation","Filter by Location"),name:"BatchLocationUuid",controllerName:"BatchLocationUuid"}))},columns:O,data:I,totalItems:A,goToPage:S,hasToolbar:!0})};var b=t(1409),h=t(6312),k=t(3775),U=t(3566),A=t(954),S=t(1604),C=S.z.object({id:S.z.string().nullish(),uuid:S.z.string().nullish(),stockItemUuid:S.z.string().nullish(),packagingUomName:S.z.string().nullish(),packagingUomUuid:S.z.string().nullish(),factor:S.z.coerce.number().nullish(),isDefaultStockOperationsUoM:S.z.boolean().nullish(),isDispensingUnit:S.z.boolean().nullish()}),E=t(9462);const _=function(e){return a().createElement(s.Qr,{name:e.controllerName,control:e.control,render:function(n){var t,r,o,i=n.field,c=i.onChange,u=i.value,s=i.ref;return a().createElement(l.Y2U,{disableWheel:!0,label:e.label,id:"".concat(e.name,"-").concat(e.id,"-").concat(null===(t=e.row)||void 0===t?void 0:t.uuid),value:null!==(o=null===(r=e.row)||void 0===r?void 0:r.factor)&&void 0!==o?o:u,min:e.min,hideSteppers:e.hideSteppers||!1,ref:s,onChange:function(n,t){c(n,t),e.onChange&&e.onChange(n,t)}})}})};var w=t(9084);function O(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function I(e){return function(e){if(Array.isArray(e))return O(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(e){if("string"==typeof e)return O(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?O(e,n):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const P=function(e){var n=(0,k.useConfig)().packagingUnitsUUID,t=(0,d.K2)(n),r=t.items.answers;return t.isLoading?a().createElement(l.znL,null):a().createElement(s.Qr,{name:e.controllerName,control:e.control,render:function(n){var t,o,i,c,u,s,d,m,p,g=n.field.onChange;return a().createElement(l.CtY,{titleText:e.title,name:e.name,control:e.control,controllerName:e.controllerName,id:"".concat(e.name,"-").concat(e.row.id,"-").concat(e.row.uuid),size:"md",items:void 0!==(null===(t=e.row)||void 0===t?void 0:t.packagingUomUuid)?I(r.some((function(n){var t;return n.uuid===(null===(t=e.row)||void 0===t?void 0:t.packagingUomUuid)}))?[]:[{uuid:null===(o=e.row)||void 0===o?void 0:o.packagingUomUuid,display:null===(i=e.row)||void 0===i?void 0:i.packagingUomName}]).concat(I(null!=r?r:[])):r||[],onChange:function(n){var t,r;null===(t=e.onPackageUnitChange)||void 0===t||t.call(e,null==n?void 0:n.selectedItem),g((null==n||null===(r=n.selectedItem)||void 0===r?void 0:r.uuid)||"")},initialSelectedItem:void 0!==(null===(c=e.row)||void 0===c?void 0:c.packagingUomUuid)?{uuid:null===(u=e.row)||void 0===u?void 0:u.packagingUomUuid,display:null===(s=e.row)||void 0===s?void 0:s.packagingUomName}:null,selectedItem:void 0!==(null===(d=e.row)||void 0===d?void 0:d.packagingUomUuid)?{uuid:null===(m=e.row)||void 0===m?void 0:m.packagingUomUuid,display:null===(p=e.row)||void 0===p?void 0:p.packagingUomName}:null,itemToString:function(e){return e&&(null==e?void 0:e.display)?"".concat(null==e?void 0:e.display):""},shouldFilterItem:function(){return!0},placeholder:e.placeholder,invalid:e.invalid,invalidText:e.invalidText})}})};var N=t(3440);function T(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function j(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function x(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){j(e,n,t[n])}))}return e}function D(e,n){return n=null!=n?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):function(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})),e}function M(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,o=[],i=!0,l=!1;try{for(t=t.call(e);!(i=(r=t.next()).done)&&(o.push(r.value),!n||o.length!==n);i=!0);}catch(e){l=!0,a=e}finally{try{i||null==t.return||t.return()}finally{if(l)throw a}}return o}}(e,n)||z(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(e){return function(e){if(Array.isArray(e))return T(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||z(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(e,n){if(e){if("string"==typeof e)return T(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?T(e,n):void 0}}const $=function(e){var n=e.stockItemUuid,t=e.handleTabChange,i=(0,E.z)(),c=i.items,u=i.isLoading,d=i.setStockItemUuid,m=i.mutate,p=M((0,r.useState)(c),2),g=p[0],f=p[1],y=M((0,r.useState)({packagingUomUuid:void 0,factor:0,packagingUomName:""}),2),v=y[0],S=y[1];(0,r.useEffect)((function(){d(n)}),[n,d]),(0,r.useEffect)((function(){f(c)}),[c]);var _=(0,o.useTranslation)().t,w=(0,r.useMemo)((function(){return[{key:"packaging",header:_("packagingUnit","Packaging Unit"),styles:{width:"50%"}},{key:"quantity",header:_("packSize","Pack Size"),styles:{width:"50%"}},{key:"action",header:_("action","Actions"),styles:{width:"50%"}}]}),[_]),O=(0,s.cI)({defaultValues:{},mode:"all",resolver:(0,h.F)(C)});return u?a().createElement(l.gqd,{showHeader:!1,rowCount:5,columnCount:5,zebra:!0}):a().createElement(s.RV,O,a().createElement(l.wQF,{rows:L(c).concat([{}]),headers:w,isSortable:!1,useZebraStyles:!0,render:function(e){var n=e.headers,t=e.getHeaderProps,r=e.getTableProps;return a().createElement(l.xJi,{className:N.Z.packagingTableContainer},a().createElement(l.iA_,D(x({},r()),{className:N.Z.packingTable}),a().createElement(l.ssF,null,a().createElement(l.SCH,null,n.map((function(e){var n,r;return a().createElement(l.xDH,D(x({},t({header:e,isSortable:!1})),{style:e.styles,key:e.key}),null!==(r=null===(n=e.header)||void 0===n?void 0:n.content)&&void 0!==r?r:e.header)})),a().createElement(l.xDH,{style:{width:"70%"}}))),a().createElement(l.RMI,{className:N.Z.packingTableBody},null==c?void 0:c.map((function(e,n){return a().createElement(F,{row:e,id:"".concat(n,"-").concat(null==e?void 0:e.uuid),onChange:function(n){return function(e,n){var t="number"==typeof n?n:parseFloat(n);f((function(n){return n.map((function(n){return n.uuid===e.uuid?D(x({},n),{factor:t}):n}))}))}(e,n)}})})),a().createElement(F,{row:v||{},id:"new-package-unit",isEditing:!0,onChangePackageUnit:function(e){return n=e,void S(D(x({},v),{packagingUomUuid:n.uuid,packagingUomName:n.display}));var n},onChange:function(e){return function(e){S(D(x({},v),{factor:Number(e)}))}(e)}}))))}}),a().createElement("div",{className:N.Z.packageUnitsBtn},a().createElement(l.zxk,{kind:"secondary",onClick:function(){t(0)}},(0,k.getCoreTranslation)("cancel")),a().createElement(l.zxk,{name:"save",type:"submit",className:"submitButton",onClick:function(){var e=O.reset,r=v?{factor:v.factor,packagingUomUuid:v.packagingUomUuid,stockItemUuid:n}:null,a=g.filter((function(e){var n=c.find((function(n){return n.uuid===e.uuid}));return n&&n.factor!==e.factor})),o=r.packagingUomUuid?(0,U.By)(r).then((function(){(0,k.showSnackbar)({title:_("savePackingUnitTitle","Package Unit"),subtitle:_("savePackingUnitMessage","Package Unit saved successfully"),kind:"success"}),S({factor:0,packagingUomUuid:void 0,packagingUomName:""})}),(function(){(0,k.showSnackbar)({title:_("savePackagingUnitErrorTitle","Package Unit"),subtitle:_("savePackagingUnitErrorMessage","Error saving package unit"),kind:"error"})})):Promise.resolve({status:"no-create"}),i=a.map((function(e){return(0,U.sY)(e,e.uuid).then((function(){(0,k.showSnackbar)({title:_("updatePackingUnitTitle","Package Unit"),subtitle:_("updatePackingUnitMessage","Package Unit {{ name }} updated successfully",{name:e.packagingUomName}),kind:"success"})}),(function(){(0,k.showSnackbar)({title:_("updatePackagingUnitErrorTitle","Package Unit"),subtitle:_("updatePackagingUnitErrorMessage","Error updating package unit {{name}}",{name:e.packagingUomName}),kind:"error"})}))}));Promise.all([o].concat(L(i))).then((function(){m(),(0,A.d)("".concat(k.restBaseUrl,"/stockmanagement/stockitem")),e(),t(0)}))},kind:"primary",renderIcon:b.vc},(0,k.getCoreTranslation)("save"))))};var B,F=function(e){var n=e.isEditing,t=e.row,r=e.id,o=e.onChange,i=e.onChangePackageUnit,c=(0,s.Gc)(),u=c.control,d=c.formState.errors;return a().createElement(a().Fragment,null,a().createElement(l.SCH,null,a().createElement(l.pj1,null,n?a().createElement(P,{row:t,controllerName:"packagingUomUuid",name:"packagingUomUuid",placeholder:"Filter",control:u,onPackageUnitChange:function(e){return i(e)},invalid:!!d.packagingUomUuid}):(!n||!t.uuid.startsWith("new-item"))&&(null==t?void 0:t.packagingUomName)),a().createElement(l.pj1,null,a().createElement(_,{row:t,controllerName:"factor",name:"factor",min:0,control:u,id:r,invalid:!!d.factor,hideSteppers:!0,onChange:function(e,n){return o(n.value)}})),a().createElement(l.pj1,null,a().createElement(w.Z,{closeModal:function(){return!0},row:t}))))},R=t(3967),q=t.n(R);!function(e){e.PHARMACEUTICALS="Pharmaceuticals",e.NONE_PHARMACEUTICALS="Non Pharmaceuticals"}(B||(B={}));var Z=[{label:"Pharmaceuticals",value:!0},{label:"Non Pharmaceuticals",value:!1}],H=[{label:"Yes",value:!0},{label:"No",value:!1}],Y=t(6075),V=S.z.string().max(255).nullish(),G=S.z.object({isDrug:S.z.boolean(),drugUuid:S.z.string().nullish(),drugName:S.z.string().nullish(),commonName:V,acronym:V,hasExpiration:S.z.boolean(),expiryNotice:S.z.coerce.number().nullish(),uuid:S.z.string().nullish(),conceptUuid:S.z.string().nullish(),conceptName:S.z.string().nullish(),preferredVendorUuid:S.z.string().nullish(),preferredVendorName:S.z.string().nullish(),purchasePrice:S.z.coerce.number().nullish(),purchasePriceUoMUuid:S.z.string().nullish(),purchasePriceUoMName:S.z.string().nullish(),categoryUuid:S.z.string().nullish(),categoryName:S.z.string().nullish(),dispensingUnitUuid:S.z.string().nullish(),dispensingUnitName:S.z.string().nullish(),dispensingUnitPackagingUoMUuid:S.z.string().nullish(),dispensingUnitPackagingUoMName:S.z.string().nullish(),defaultStockOperationsUoMUuid:S.z.string().nullish(),defaultStockOperationsUoMName:S.z.string().nullish(),reorderLevel:S.z.coerce.number().nullish(),reorderLevelUoMUuid:S.z.string().nullish(),reorderLevelUoMName:S.z.string().nullish(),dateCreated:S.z.coerce.date().nullish(),creatorGivenName:S.z.string().nullish(),creatorFamilyName:S.z.string().nullish(),voided:S.z.boolean().nullish()}).refine((function(e){var n=e.isDrug,t=e.drugUuid;return!n||!!t}),{message:"Drug required",path:["drugUuid"]}).refine((function(e){var n=e.isDrug,t=e.dispensingUnitUuid;return!n||!!t}),{message:"Dispensing Unit required",path:["dispensingUnitUuid"]}).refine((function(e){var n=e.hasExpiration,t=e.expiryNotice;return!n||!!t}),{message:"Expiry Notice required",path:["expiryNotice"]});function Q(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}const W=function(e){var n,t,o=(0,d.Cm)({}),i=o.items.results,c=o.isLoading,u=(n=(0,r.useState)(""),t=2,function(e){if(Array.isArray(e))return e}(n)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,o=[],i=!0,l=!1;try{for(t=t.call(e);!(i=(r=t.next()).done)&&(o.push(r.value),!n||o.length!==n);i=!0);}catch(e){l=!0,a=e}finally{try{i||null==t.return||t.return()}finally{if(l)throw a}}return o}}(n,t)||function(e,n){if(e){if("string"==typeof e)return Q(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Q(e,n):void 0}}(n,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),m=u[0],p=u[1],g=(0,r.useMemo)((function(){return""===m.trim()?i:i.filter((function(e){var n,t;return null===(t=e.display)||void 0===t?void 0:t.toLowerCase().includes(null===(n=m.trim())||void 0===n?void 0:n.toLowerCase())}))}),[m,i]);return c?a().createElement(l.znL,null):a().createElement(s.Qr,{name:e.controllerName,control:e.control,render:function(n){var t=n.field,r=t.onChange,o=t.ref;return a().createElement(l.CtY,{titleText:e.title,name:e.name,control:e.control,controllerName:e.controllerName,id:e.name,size:"md",items:g,onChange:function(n){var t;null===(t=e.onConceptUuidChange)||void 0===t||t.call(e,n.selectedItem),r(n.selectedItem.uuid)},initialSelectedItem:(null==i?void 0:i.find((function(n){return n.uuid===e.conceptUuid})))||{},itemToString:function(e){return e&&(null==e?void 0:e.display)?"".concat(null==e?void 0:e.display):""},shouldFilterItem:function(){return!0},onInputChange:function(e){p(e)},inputValue:m,placeholder:e.placeholder,ref:o,invalid:e.invalid,invalidText:e.invalidText})}})};function K(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}const J=function(e){return a().createElement(s.Qr,{name:e.controllerName,control:e.control,render:function(n){var t,r,o=n.field,i=o.onChange,c=o.value,u=o.ref;return a().createElement(l.SYO,(t=function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){K(e,n,t[n])}))}return e}({},e),r=null!=(r={onChange:function(n,t,r){i(n,t,r),e.onChange&&e.onChange(n,t,r)},id:e.name,ref:u,defaultSelected:e.id,value:c})?r:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):function(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})),t),e.options.map((function(n,t){return a().createElement(l.EUY,{key:"".concat(t,"-").concat(e.name,"-").concat(n.value),id:"".concat(e.name,"-").concat(n.value),labelText:n.label,value:n.value,checked:c===n.value,onChange:function(){return i(n.value)},ref:u})})))}})};function X(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}const ee=function(e){return a().createElement(s.Qr,{name:e.controllerName,control:e.control,render:function(n){var t,r,o=n.field,i=o.onChange,c=o.value,u=o.ref;return a().createElement(l.oil,(t=function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){X(e,n,t[n])}))}return e}({},e),r=null!=(r={onChange:function(n){i(n.target.value),e.onChange&&e.onChange(n)},id:e.id,ref:u,value:null!=c?c:e.value})?r:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):function(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})),t))}})},ne=function(e){var n=(0,k.useConfig)().dispensingUnitsUUID,t=(0,d.K2)(n),r=t.items.setMembers;return t.isLoading?a().createElement(l.znL,null):a().createElement(s.Qr,{name:e.controllerName,control:e.control,render:function(n){var t,o,i=n.field,c=i.onChange,u=i.value,s=i.ref;return a().createElement(l.CtY,{titleText:e.title,name:e.name,control:e.control,controllerName:e.controllerName,id:e.name,size:"md",items:r||[],onChange:function(n){var t;null===(t=e.onDispensingUnitChange)||void 0===t||t.call(e,n.selectedItem),c(n.selectedItem.uuid)},initialSelectedItem:(null==r?void 0:r.find((function(n){return n.uuid===e.dispensingUnitUuid})))||{},itemToString:function(e){return e&&(null==e?void 0:e.display)?"".concat(null==e?void 0:e.display):""},shouldFilterItem:function(){return!0},value:null!==(o=null==r||null===(t=r.find((function(e){return e.uuid===u})))||void 0===t?void 0:t.display)&&void 0!==o?o:"",placeholder:e.placeholder,ref:s,invalid:e.invalid,invalidText:e.invalidText})}})};var te=t(2484);function re(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function ae(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,o=[],i=!0,l=!1;try{for(t=t.call(e);!(i=(r=t.next()).done)&&(o.push(r.value),!n||o.length!==n);i=!0);}catch(e){l=!0,a=e}finally{try{i||null==t.return||t.return()}finally{if(l)throw a}}return o}}(e,n)||function(e,n){if(e){if("string"==typeof e)return re(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?re(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oe(e){return e?"".concat(e.name).concat(e.concept?" (".concat(e.concept.display,")"):""):""}const ie=function(e){var n,t,i,c=ae((0,r.useState)(""),2),u=c[0],m=c[1],p=(0,o.useTranslation)().t,g=(n=u,t={v:te._.Default,q:n,limit:20},{drugList:(i=(0,d.z$)(t)).items.results,isLoading:i.isLoading}),f=g.isLoading,y=g.drugList,v=ae((0,r.useState)(!1),2),b=v[0],h=v[1];return a().createElement("div",null,a().createElement(s.Qr,{name:e.controllerName,control:e.control,render:function(n){var t,r=n.field,o=r.onChange,i=r.ref;return a().createElement(l.CtY,{titleText:e.title,name:e.name,control:e.control,controllerName:e.controllerName,id:e.name,size:"md",items:y||[],initialSelectedItem:null!==(t=null==y?void 0:y.find((function(n){return n.uuid===e.drugUuid})))&&void 0!==t?t:"",itemToString:oe,onChange:function(n){var t,r,a,i,l;h(!1),null===(t=e.onDrugChanged)||void 0===t||t.call(e,n.selectedItem),o(null==n||null===(r=n.selectedItem)||void 0===r?void 0:r.uuid),(null==n||null===(a=n.selectedItem)||void 0===a?void 0:a.uuid)&&(l=null==n||null===(i=n.selectedItem)||void 0===i?void 0:i.uuid)&&(0,U.N_)(l).then((function(e){var n,t,r=0!==(null!==(t=null==e||null===(n=e.results)||void 0===n?void 0:n.length)&&void 0!==t?t:0);h(r)}))},onInputChange:function(e){m(e)},inputValue:u,placeholder:e.placeholder,invalid:e.invalid,invalidText:e.invalidText,ref:i})}}),f&&a().createElement(l.lSo,{status:"active",iconDescription:"Searching",description:"Searching..."}),b&&a().createElement("div",{style:{color:"#da1e28"}},p("itemAlreadyExists","Item already exits")))};var le=t(8510);const ce=function(e){var n=(0,le.eW)({v:te._.Default}),t=n.items.results;return n.isLoading?a().createElement(l.znL,null):a().createElement(s.Qr,{name:e.controllerName,control:e.control,render:function(n){var r,o,i=n.field,c=i.onChange,u=i.value,s=i.ref;return a().createElement(l.CtY,{titleText:e.title,name:e.name,control:e.control,controllerName:e.controllerName,id:e.name,size:"md",items:t||[],onChange:function(n){var t,r;null===(t=e.onPreferredVendorChange)||void 0===t||t.call(e,n.selectedItem),c(null===(r=n.selectedItem)||void 0===r?void 0:r.uuid)},initialSelectedItem:(null==t?void 0:t.find((function(n){return n.uuid===e.preferredVendorUuid})))||{},itemToString:function(e){return e&&(null==e?void 0:e.name)?"".concat(null==e?void 0:e.name):""},shouldFilterItem:function(){return!0},value:null!==(o=null==t||null===(r=t.find((function(e){return e.uuid===u})))||void 0===r?void 0:r.name)&&void 0!==o?o:"",placeholder:e.placeholder,ref:s,invalid:e.invalid,invalidText:e.invalidText})}})},ue=function(e){var n=(0,o.useTranslation)().t,t=(0,k.useConfig)().stockItemCategoryUUID,r=(0,d.K2)(t),i=r.items.answers,c=r.isLoading,u=e.itemType?null==i?void 0:i.filter((function(n){return n.display===(null==e?void 0:e.itemType)})):i;return c?a().createElement(l.znL,null):a().createElement(s.Qr,{name:e.controllerName,control:e.control,render:function(t){var r,o,c=t.field,s=c.onChange,d=c.value,m=c.ref;return a().createElement(l.CtY,{titleText:e.title,name:e.name,control:e.control,controllerName:e.controllerName,id:e.name,size:"md",items:u||[],onChange:function(n){var t,r;null===(t=e.onCategoryUuidChange)||void 0===t||t.call(e,n.selectedItem),s(null===(r=n.selectedItem)||void 0===r?void 0:r.uuid)},initialSelectedItem:(null==i?void 0:i.find((function(n){return n.uuid===e.categoryUuid})))||{},itemToString:function(e){return e&&(null==e?void 0:e.display)?"".concat(n(null==e?void 0:e.display)):""},shouldFilterItem:function(){return!0},value:null!==(o=n(null==i||null===(r=i.find((function(e){return e.uuid===d})))||void 0===r?void 0:r.display))&&void 0!==o?o:"",placeholder:e.placeholder,ref:m,invalid:e.invalid,invalidText:e.invalidText})}})},se=function(e){var n,t=(0,r.useMemo)((function(){return(null==e?void 0:e.packagingUnits.length)>0?null==e?void 0:e.packagingUnits.find((function(n){return(null==n?void 0:n.uuid)===(null==e?void 0:e.dispensingUnitPackagingUoMUuid)})):null}),[null==e?void 0:e.packagingUnits,null==e?void 0:e.dispensingUnitPackagingUoMUuid]);return e.isLoading?a().createElement(l.xNL,null):(null==e?void 0:e.packagingUnits)&&(null==e?void 0:e.packagingUnits.length)>0?a().createElement("div",null,a().createElement(s.Qr,{name:e.controllerName,control:e.control,defaultValue:null!==(n=null==t?void 0:t.uuid)&&void 0!==n?n:"",render:function(n){var r,o=n.field,i=o.onChange,c=o.ref;return a().createElement(l.CtY,{titleText:e.title,name:e.name,control:e.control,controllerName:e.controllerName,id:e.name,size:"sm",items:null!==(r=e.packagingUnits)&&void 0!==r?r:[],onChange:function(n){var t,r;null===(t=e.onDispensingUnitPackagingUoMUuidChange)||void 0===t||t.call(e,null==n?void 0:n.selectedItem),i(null==n||null===(r=n.selectedItem)||void 0===r?void 0:r.uuid)},initialSelectedItem:t,itemToString:function(e){return(null==e?void 0:e.packagingUomName)?"".concat(null==e?void 0:e.packagingUomName," - ").concat(null==e?void 0:e.factor," "):"Not set"},placeholder:e.placeholder,invalid:e.invalid,invalidText:e.invalidText,ref:c})}})):a().createElement(a().Fragment,null)},de=function(e){var n,t,r,i,c,u,s,d,m=e.stockItemUuid,p=e.control,g=e.formState.errors,f=(0,o.useTranslation)().t,y=(0,U.GY)(m),v=y.item,b=y.isLoading;return v&&v.packagingUnits&&v.packagingUnits.length>0?a().createElement(a().Fragment,null,a().createElement(se,{dispensingUnitPackagingUoMUuid:null==v?void 0:v.dispensingUnitPackagingUoMUuid,name:"dispensingUnitPackagingUoMUuid",controllerName:"dispensingUnitPackagingUoMUuid",control:p,title:f("dispensingUnitOfMeasurement","Dispensing packaging unit of measurement")+":",placeholder:f("chooseAPackagingUoM","Choose a packaging UoM"),isLoading:b,packagingUnits:v.packagingUnits,invalid:!!g.dispensingUnitPackagingUoMUuid,invalidText:g.dispensingUnitPackagingUoMUuid&&(null==g||null===(n=g.dispensingUnitPackagingUoMUuid)||void 0===n?void 0:n.message)}),a().createElement(se,{dispensingUnitPackagingUoMUuid:null==v?void 0:v.defaultStockOperationsUoMUuid,name:"defaultStockOperationsUoMUuid",controllerName:"defaultStockOperationsUoMUuid",control:p,title:f("defaultStockOperationsPackagingUnit","Default stock operations packaging unit")+":",placeholder:f("chooseAPackagingUoM","Choose a packaging UoM"),isLoading:b,packagingUnits:v.packagingUnits,invalid:!!g.defaultStockOperationsUoMUuid,invalidText:g.defaultStockOperationsUoMUuid&&(null==g||null===(t=g.defaultStockOperationsUoMUuid)||void 0===t?void 0:t.message)}),b?a().createElement(l.iJ5,null):a().createElement(_,{id:"reorderLevel",name:"reorderLevel",control:p,controllerName:"reorderLevel",size:"md",allowEmpty:!0,label:f("orderLevel","Reorder level")+":",invalid:!!g.reorderLevel,value:null!==(s=v.reorderLevel)&&void 0!==s?s:"",hideSteppers:!0,invalidText:g.reorderLevel&&(null==g||null===(r=g.reorderLevel)||void 0===r?void 0:r.message)}),a().createElement(se,{dispensingUnitPackagingUoMUuid:null==v?void 0:v.purchasePriceUoMUuid,name:"reorderLevelUoMUuid",controllerName:"reorderLevelUoMUuid",control:p,title:f("reorderLevelPackagingUnit","Reorder level packaging unit")+":",placeholder:f("notSet","Not Set"),isLoading:b,packagingUnits:v.packagingUnits,invalid:!!g.reorderLevelUoMUuid,invalidText:g.reorderLevelUoMUuid&&(null==g||null===(i=g.reorderLevelUoMUuid)||void 0===i?void 0:i.message)}),b?a().createElement(l.iJ5,null):a().createElement(_,{id:"purchasePrice",name:"purchasePrice",control:p,controllerName:"purchasePrice",size:"md",allowEmpty:!0,label:f("purchasePrice","Purchase Price")+":",value:null!==(d=v.purchasePrice)&&void 0!==d?d:"",invalid:!!g.purchasePrice,hideSteppers:!0,invalidText:g.purchasePrice&&(null==g||null===(c=g.purchasePrice)||void 0===c?void 0:c.message)}),a().createElement(se,{dispensingUnitPackagingUoMUuid:null==v?void 0:v.purchasePriceUoMUuid,name:"purchasePriceUoMUuid",controllerName:"purchasePriceUoMUuid",control:p,title:f("purchasePricePackagingUnit","Purchase price packaging unit")+":",placeholder:f("notSet","Not Set"),isLoading:b,packagingUnits:v.packagingUnits,invalid:!!g.purchasePriceUoMUuid,invalidText:g.purchasePriceUoMUuid&&(null==g||null===(u=g.purchasePriceUoMUuid)||void 0===u?void 0:u.message)})):a().createElement(a().Fragment,null)};var me=t(7410),pe=t.n(me),ge=t(4766),fe=t.n(ge),ye=t(1991),ve=t.n(ye),be=t(3702),he=t.n(be),ke=t(2434),Ue=t.n(ke),Ae=t(1422),Se=t.n(Ae),Ce=t(2285),Ee={};Ee.styleTagTransform=Se(),Ee.setAttributes=he(),Ee.insert=ve().bind(null,"head"),Ee.domAPI=fe(),Ee.insertStyleElement=Ue(),pe()(Ce.Z,Ee);const _e=Ce.Z&&Ce.Z.locals?Ce.Z.locals:void 0;function we(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function Oe(e,n,t,r,a,o,i){try{var l=e[o](i),c=l.value}catch(e){return void t(e)}l.done?n(c):Promise.resolve(c).then(r,a)}function Ie(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}const Pe=(0,r.forwardRef)((function(e){var n,t,i,c,u,d,m,p,g,f,y,v,S,C,E,w,O=e.stockItem,I=e.handleTabChange,P=e.onCloseWorkspace,N=(0,o.useTranslation)().t,T="tablet"===(0,k.useLayoutType)(),j=(0,s.cI)({defaultValues:null!=O?O:{},mode:"all",resolver:(0,h.F)(G)}),x=j.handleSubmit,D=j.control,M=j.formState,L=j.watch,z=M.errors,$=(y=function(e){var n,t,r,a,o,i;return function(e,n){var t,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=n.call(e,i)}catch(e){o=[6,e],r=0}finally{t=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}(this,(function(l){switch(l.label){case 0:return l.trys.push([0,5,,6]),O?[4,(0,U.xS)(null==O?void 0:O.uuid,e)]:[3,2];case 1:return t=l.sent(),[3,4];case 2:return[4,(0,U.Y5)(e)];case 3:t=l.sent(),l.label=4;case 4:return(null==(n=t)?void 0:n.data)&&((0,k.showSnackbar)({isLowContrast:!0,title:"".concat(O?N("editStockItem","Edit Stock Item"):N("addStockItem","Add Stock Item")),kind:"success",subtitle:"".concat(O?N("stockItemEdited","Stock Item Edited Successfully"):N("stockItemAdded","Stock Item Added Successfully"))}),O||(null==P||P(),(r=n.data).isDrug=!!r.drugUuid,(0,Y.S)(N,r))),I(1),(0,A.d)("".concat(k.restBaseUrl,"/stockmanagement/stockitem")),[3,6];case 5:return a=l.sent(),(0,k.showSnackbar)({title:O?N("errorEditingStockItem","Error editing a stock Item"):N("errorAddingStockItem","Error adding a stock Item"),kind:"error",isLowContrast:!0,subtitle:null==a||null===(i=a.responseBody)||void 0===i||null===(o=i.error)||void 0===o?void 0:o.message}),[3,6];case 6:return[2]}}))},v=function(){var e=this,n=arguments;return new Promise((function(t,r){var a=y.apply(e,n);function o(e){Oe(a,t,r,o,i,"next",e)}function i(e){Oe(a,t,r,o,i,"throw",e)}o(void 0)}))},function(e){return v.apply(this,arguments)}),F=(E=L(["isDrug","hasExpiration"]),w=2,function(e){if(Array.isArray(e))return e}(E)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,o=[],i=!0,l=!1;try{for(t=t.call(e);!(i=(r=t.next()).done)&&(o.push(r.value),!n||o.length!==n);i=!0);}catch(e){l=!0,a=e}finally{try{i||null==t.return||t.return()}finally{if(l)throw a}}return o}}(E,w)||function(e,n){if(e){if("string"==typeof e)return we(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?we(e,n):void 0}}(E,w)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),R=F[0],V=F[1],Q=(0,r.useMemo)((function(){return!0===R?B.PHARMACEUTICALS:!1===R?B.NONE_PHARMACEUTICALS:null}),[R]);return a().createElement("form",{className:_e.formContainer},a().createElement(l.Kqy,{className:_e.stack,gap:5},!O&&a().createElement(l.cwH,{className:"clear-margin-bottom",legendText:N("itemType","Item Type"),title:N("itemType","Item Type")},a().createElement(J,{control:D,name:"isDrug",controllerName:"isDrug",legendText:"",invalid:!!z.isDrug,invalidText:z.isDrug&&(null==z||null===(n=z.isDrug)||void 0===n?void 0:n.message),options:Z})),Q===B.PHARMACEUTICALS?a().createElement(ie,{name:"drugUuid",controllerName:"drugUuid",control:D,title:N("pleaseSpecify","Please specify:"),placeholder:"Choose a drug",drugUuid:null==O?void 0:O.drugUuid,invalid:!!z.drugUuid,invalidText:z.drugUuid&&(null==z||null===(t=z.drugUuid)||void 0===t?void 0:t.message)}):Q===B.NONE_PHARMACEUTICALS?a().createElement(W,{name:"conceptUuid",controllerName:"conceptUuid",control:D,title:N("pleaseSpecify","Please specify")+":",placeholder:N("chooseAnItem","Choose an item"),invalid:!!z.drugUuid,invalidText:z.drugUuid&&(null==z||null===(i=z.drugUuid)||void 0===i?void 0:i.message)}):null,a().createElement(ee,{id:"commonName",name:"commonName",control:D,controllerName:"commonName",maxLength:255,size:"md",value:"".concat(null!==(S=null==O?void 0:O.commonName)&&void 0!==S?S:""),labelText:N("commonName","Common name")+":",invalid:!!z.commonName,invalidText:z.commonName&&(null==z||null===(c=z.commonName)||void 0===c?void 0:c.message)}),a().createElement(ee,{id:"acronym",maxLength:255,name:"acronym",control:D,controllerName:"acronym",size:"md",labelText:N("abbreviation","Abbreviation")+":",invalid:!!z.acronym,invalidText:z.acronym&&(null==z||null===(u=z.acronym)||void 0===u?void 0:u.message)}),a().createElement("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",justifyContent:"center"}},a().createElement(l.cwH,{className:"clear-margin-bottom",legendText:N("hasExpiration","Does the item expire?"),title:N("hasExpiration","Does the item expire?")},a().createElement(J,{name:"hasExpiration",controllerName:"hasExpiration",control:D,legendText:"",invalid:!!z.hasExpiration,invalidText:z.hasExpiration&&(null==z||null===(d=z.hasExpiration)||void 0===d?void 0:d.message),options:H})),V&&a().createElement(l.cwH,{className:"clear-margin-bottom",title:N("expirationNotice","Expiration Notice (days)")},a().createElement(_,{id:"expiryNotice",name:"expiryNotice",control:D,controllerName:"expiryNotice",min:0,hideSteppers:!0,size:"md",allowEmpty:!0,label:N("expiryNoticeDays","Expiration Notice (days)"),invalid:!!z.expiryNotice,invalidText:z.expiryNotice&&(null==z||null===(m=z.expiryNotice)||void 0===m?void 0:m.message)}))),a().createElement(ce,{name:"preferredVendorUuid",controllerName:"preferredVendorUuid",control:D,title:N("whoIsThePreferredVendor","Who is the preferred vendor?"),placeholder:N("chooseVendor","Choose vendor"),invalid:!!z.preferredVendorUuid,invalidText:z.preferredVendorUuid&&(null==z||null===(p=z.preferredVendorUuid)||void 0===p?void 0:p.message)}),a().createElement(ue,{name:"categoryUuid",controllerName:"categoryUuid",control:D,itemType:Q===B.PHARMACEUTICALS?"Drugs":Q===B.NONE_PHARMACEUTICALS?"Non Drugs":void 0,title:N("category","Category")+":",placeholder:N("chooseACategory","Choose a category"),invalid:!!z.categoryUuid,invalidText:z.categoryUuid&&(null==z||null===(g=z.categoryUuid)||void 0===g?void 0:g.message)}),R&&a().createElement(ne,{name:"dispensingUnitUuid",controllerName:"dispensingUnitUuid",control:D,title:N("dispensingUnit","Dispensing Unit")+":",placeholder:N("dispensingUnitHolder","Choose a dispensing unit"),invalid:!!z.dispensingUnitUuid,invalidText:z.dispensingUnitUuid&&(null==z||null===(f=z.dispensingUnitUuid)||void 0===f?void 0:f.message)}),R&&O&&a().createElement(de,{control:D,formState:M,stockItemUuid:null==O?void 0:O.uuid})),a().createElement(l.uVA,{className:q()(_e.buttonSet,(C={},Ie(C,_e.tablet,T),Ie(C,_e.desktop,!T),C))},a().createElement(l.zxk,{kind:"secondary",onClick:P,className:_e.button},(0,k.getCoreTranslation)("cancel")),a().createElement(l.zxk,{className:_e.button,kind:"primary",name:"save",onClick:x($),renderIcon:b.vc,type:"button"},M.isSubmitting?a().createElement(l.lSo,null):(0,k.getCoreTranslation)("save"))))}));function Ne(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}const Te=function(e){var n=e.stockItemUuid,t=(0,o.useTranslation)().t,i=(0,r.useCallback)((function(){(0,k.launchWorkspace)("stock-item-rules-form-workspace",{workspaceTitle:t("addStockRule","Add stock rule"),stockItemUuid:n})}),[n,t]);return a().createElement(l.zxk,{onClick:i,size:"md",kind:"primary"},t("addNewStockRule","Add New Rule"))};var je=t(6160);function xe(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}const De=function(e){var n=e.data,t=e.stockItemUuid,i=(0,o.useTranslation)().t,c=(0,r.useCallback)((function(){(0,k.launchWorkspace)("stock-item-rules-form-workspace",{workspaceTitle:i("editStockRule","Edit Stock Rule"),stockItemUuid:t,model:n})}),[n,i,t]);return a().createElement(l.zxk,{kind:"ghost",size:"md",onClick:function(){return c()},iconDescription:i("editStockRule","Edit Stock Rule"),renderIcon:function(e){return a().createElement(je.I8,function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){xe(e,n,t[n])}))}return e}({size:16},e))}})};var Me=t(4797);function Le(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function ze(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}const $e=function(e){var n,t,i=e.uuid,c=(0,o.useTranslation)().t,u=(n=(0,r.useState)(!1),t=2,function(e){if(Array.isArray(e))return e}(n)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,o=[],i=!0,l=!1;try{for(t=t.call(e);!(i=(r=t.next()).done)&&(o.push(r.value),!n||o.length!==n);i=!0);}catch(e){l=!0,a=e}finally{try{i||null==t.return||t.return()}finally{if(l)throw a}}return o}}(n,t)||function(e,n){if(e){if("string"==typeof e)return Le(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Le(e,n):void 0}}(n,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=u[0],d=u[1],m=a().useCallback((function(){var e=(0,k.showModal)("delete-stock-rule-modal",{close:function(){return e()},uuid:i,onConfirmation:function(){(0,U.Mk)(i).then((function(){d(!1),(0,k.showSnackbar)({isLowContrast:!0,title:c("deletingRule","Delete Rule"),kind:"success",subtitle:c("stockRuleDeletedSuccessfully","Stock Rule Deleted Successfully")})}),(function(e){d(!1),(0,k.showSnackbar)({title:c("errorDeletingRule","Error deleting a rule"),kind:"error",isLowContrast:!0,subtitle:null==e?void 0:e.message})})).catch(),e()}})}),[c,i]),p=a().createElement(l.zxk,{kind:"ghost",size:"md",onClick:m,iconDescription:c("deleteRule","Delete Rule"),renderIcon:function(e){return a().createElement(Me.ZN,function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){ze(e,n,t[n])}))}return e}({size:16},e))}});return s?a().createElement(l.lSo,null):p};var Be=t(2916),Fe={};Fe.styleTagTransform=Se(),Fe.setAttributes=he(),Fe.insert=ve().bind(null,"head"),Fe.domAPI=fe(),Fe.insertStyleElement=Ue(),pe()(Be.Z,Fe);const Re=Be.Z&&Be.Z.locals?Be.Z.locals:void 0;var qe=t(2400);function Ze(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}const He=function(e){var n,t=e.stockItemUuid,r=(0,qe.yf)({v:te._.Default,totalCount:!0,stockItemUuid:t}),o=r.items,i=r.isLoading,c=r.error;return i||c?a().createElement(l.iTo,null):a().createElement(a().Fragment,null,a().createElement("div",{className:Re.filterContainer},a().createElement(l.Ltx,{id:"stockRulesFiter",items:(n=o.results,function(e){if(Array.isArray(e))return Ze(e)}(n)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||function(e,n){if(e){if("string"==typeof e)return Ze(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Ze(e,n):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),itemToString:function(e){return e?e.display:"Not Set"},type:"inline",size:"sm"})))};var Ye=t(1866);function Ve(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function Ge(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){Ve(e,n,t[n])}))}return e}function Qe(e,n){return n=null!=n?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):function(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})),e}const We=function(e){var n=e.stockItemUuid,t=(e.model,e.canEdit,(0,o.useTranslation)().t),c=function(e){var n,t,a=(0,U.yf)(e),o=a.items,i=a.isLoading,l=a.error,c=(n=(0,r.useState)(10),t=2,function(e){if(Array.isArray(e))return e}(n)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,o=[],i=!0,l=!1;try{for(t=t.call(e);!(i=(r=t.next()).done)&&(o.push(r.value),!n||o.length!==n);i=!0);}catch(e){l=!0,a=e}finally{try{i||null==t.return||t.return()}finally{if(l)throw a}}return o}}(n,t)||function(e,n){if(e){if("string"==typeof e)return Ne(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Ne(e,n):void 0}}(n,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u=c[0],s=c[1],d=(0,k.usePagination)(o.results,u),m=d.goTo,p=d.results,g=d.currentPage,f=(0,r.useMemo)((function(){return[{key:"location",header:"Location"},{key:"name",header:"Name"},{key:"quantity",header:"Quantity Threshold"},{key:"evaluationFrequency",header:"Frequency Check"},{key:"actionFrequency",header:"Notification Frequency"},{key:"alertRole",header:"Alert Role"},{key:"mailRole",header:"Mail Role"},{key:"enabled",header:"Enabled?"},{header:"actions",key:"actions"}]}),[]);return{items:p,totalItems:null==o?void 0:o.totalCount,currentPage:g,currentPageSize:u,paginatedItems:p,goTo:m,pageSizes:[10,20,30,40,50],isLoading:i,error:l,setPageSize:s,tableHeaders:f}}({v:te._.Default,totalCount:!0,stockItemUuid:n}),u=c.isLoading,s=c.items,d=c.tableHeaders,m=c.currentPage,p=c.currentPageSize,g=c.pageSizes,f=c.totalItems,y=c.setPageSize,v=c.goTo,b=(0,r.useMemo)((function(){return null==s?void 0:s.map((function(e,n){var t,r;return Qe(Ge({},e),{id:"".concat(null==e?void 0:e.id,"-").concat(n),key:"key-".concat(null==e?void 0:e.uuid),uuid:"".concat(null==e?void 0:e.uuid),dateCreated:(0,i.up)(null==e?void 0:e.dateCreated),location:null==e?void 0:e.locationName,quantity:"".concat(null==e||null===(t=e.quantity)||void 0===t?void 0:t.toLocaleString()," ").concat(null!==(r=null==e?void 0:e.packagingUomName)&&void 0!==r?r:""),name:"".concat(null==e?void 0:e.name),description:"".concat(null==e?void 0:e.description),evaluationFrequency:"".concat(null==e?void 0:e.evaluationFrequency," minutes"),actionFrequency:"".concat(null==e?void 0:e.actionFrequency," minutes"),lastActionDate:(0,i.up)(null==e?void 0:e.lastActionDate),nextActionDate:(0,i.up)(null==e?void 0:e.nextActionDate),enabled:e.enabled?"Yes":"No",actions:a().createElement(a().Fragment,null,a().createElement(De,{data:s[n],stockItemUuid:s[n].stockItemUuid}),a().createElement($e,{uuid:s[n].uuid}))})}))}),[s]);return u?a().createElement(l.gqd,{role:"progressbar"}):a().createElement("div",{className:Ye.Z.tableOverride},a().createElement(l.wQF,{rows:b,headers:d,isSortable:!0,useZebraStyles:!0,render:function(e){var r=e.rows,o=e.headers,i=e.getHeaderProps,c=e.getTableProps,u=e.getRowProps,s=e.onInputChange;return a().createElement(l.xJi,null,a().createElement(l.fjU,{style:{position:"static",overflow:"visible",backgroundColor:"color"}},a().createElement(l.Vj0,{className:Ye.Z.toolbarContent},a().createElement(l.Ys1,{persistent:!0,onChange:s}),a().createElement("div",{style:{display:"flex",alignItems:"center"}},a().createElement(He,{stockItemUuid:n})),a().createElement(l.Voz,null,a().createElement(l.VjL,{className:Ye.Z.toolbarMenuAction,onClick:""},t("refresh","Refresh"))),a().createElement(Te,{stockItemUuid:n}))),a().createElement(l.iA_,c(),a().createElement(l.ssF,null,a().createElement(l.SCH,null,o.map((function(e){var n,t;return"details"!==e.key&&a().createElement(l.xDH,Qe(Ge({},i({header:e,isSortable:e.isSortable})),{className:k.isDesktop?Ye.Z.desktopHeader:Ye.Z.tabletHeader,key:"".concat(e.key)}),null!==(t=null===(n=e.header)||void 0===n?void 0:n.content)&&void 0!==t?t:e.header)})),a().createElement(l.xDH,null))),a().createElement(l.RMI,null,r.map((function(e){return a().createElement(a().Fragment,{key:e.id},a().createElement(l.SCH,Ge({className:k.isDesktop?Ye.Z.desktopRow:Ye.Z.tabletRow},u({row:e})),e.cells.map((function(e){var n;return"details"!==(null==e||null===(n=e.info)||void 0===n?void 0:n.header)&&a().createElement(l.pj1,{key:e.id},e.value)}))))})))),0===r.length?a().createElement("div",{className:Ye.Z.tileContainer},a().createElement(l.n9L,{className:Ye.Z.tile},a().createElement("div",{className:Ye.Z.tileContent},a().createElement("p",{className:Ye.Z.content},t("noRulesToDisplay","No Stock rules to display")),a().createElement("p",{className:Ye.Z.helper},t("checkFilters","Check the filters above"))))):null)}}),a().createElement(l.tlE,{page:m,pageSize:p,pageSizes:g,totalItems:f,onChange:function(e){var n=e.pageSize,t=e.page;n!==p&&y(n),t!==m&&v(t)},className:Ye.Z.paginationOverride}))};var Ke=t(8416);function Je(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function Xe(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,o=[],i=!0,l=!1;try{for(t=t.call(e);!(i=(r=t.next()).done)&&(o.push(r.value),!n||o.length!==n);i=!0);}catch(e){l=!0,a=e}finally{try{i||null==t.return||t.return()}finally{if(l)throw a}}return o}}(e,n)||function(e,n){if(e){if("string"==typeof e)return Je(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Je(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function en(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}const nn=function(e){var n=e.stockItemUuid,t=function(e){var n=Xe((0,r.useState)({startIndex:0,v:e||te._.Default,limit:10,q:null,totalCount:!0}),2),t=n[0],a=n[1],o=Xe((0,r.useState)(10),2),i=o[0],l=o[1],c=Xe((0,r.useState)(null),2),u=c[0],s=c[1],d=Xe((0,r.useState)(1),2),m=d[0],p=d[1],g=Xe((0,r.useState)(),2),f=g[0],y=g[1],v=Xe((0,r.useState)(),2),b=v[0],h=v[1],k=Xe((0,r.useState)(),2),A=k[0],S=k[1],C=Xe((0,r.useState)(),2),E=C[0],_=C[1];(0,r.useEffect)((function(){a({startIndex:m-1,v:te._.Default,limit:i,q:u,totalCount:!0,stockItemUuid:f,partyUuid:b,locationUuid:A,stockBatchUuid:E})}),[u,m,i,f,b,A,E]);var w,O=(0,U.gT)(t),I=O.items,P=O.isLoading,N=O.error;return{items:null!==(w=I.results)&&void 0!==w?w:[],totalCount:I.totalCount,currentPage:m,currentPageSize:i,setCurrentPage:p,setPageSize:l,pageSizes:[10,20,30,40,50],isLoading:P,error:N,setSearchString:s,setStockItemUuid:y,setLocationUuid:S,setPartyUuid:h,setStockBatchUuid:_}}(te._.Default),u=t.isLoading,s=t.items,d=t.totalCount,m=t.setCurrentPage,p=t.setStockItemUuid,g=(0,o.useTranslation)().t;(0,r.useEffect)((function(){p(n)}),[n,p]);var f=(0,r.useMemo)((function(){return[{key:"location",header:g("location","Location")},{key:"quantity",header:g("quantity","Quantity")},{key:"packaging",header:g("packagingUnit","Packaging Unit")}]}),[g]),y=(0,r.useMemo)((function(){return null==s?void 0:s.map((function(e,n){var t,r,a,o,l,c,u;return c=function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){en(e,n,t[n])}))}return e}({},e),u=null!=(u={id:"".concat(e.partyUuid).concat(e.stockBatchUuid).concat(n),key:"".concat(e.partyUuid).concat(e.stockBatchUuid).concat(n),uuid:"".concat(e.partyUuid).concat(e.stockBatchUuid).concat(n),expires:(0,i.up)(null==e?void 0:e.expiration),location:null==e?void 0:e.partyName,quantity:null!==(r=null==e||null===(t=e.quantity)||void 0===t?void 0:t.toLocaleString())&&void 0!==r?r:"",batch:null!==(a=e.batchNumber)&&void 0!==a?a:"",packaging:"".concat(null!==(o=e.quantityUoM)&&void 0!==o?o:""," of ").concat(null!==(l=e.quantityFactor)&&void 0!==l?l:"")})?u:{},Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(u)):function(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(u)).forEach((function(e){Object.defineProperty(c,e,Object.getOwnPropertyDescriptor(u,e))})),c}))}),[s]);return u?a().createElement(l.gqd,{role:"progressbar"}):a().createElement(c.Z,{columns:f,data:y,totalItems:d,goToPage:m,hasToolbar:!1})};var tn=t(1326),rn={};rn.styleTagTransform=Se(),rn.setAttributes=he(),rn.insert=ve().bind(null,"head"),rn.domAPI=fe(),rn.insertStyleElement=Ue(),pe()(tn.Z,rn);const an=tn.Z&&tn.Z.locals?tn.Z.locals:void 0,on=function(e){var n=(0,le.eW)({v:te._.Default}),t=n.items.results;return n.isLoading?a().createElement(l.znL,null):a().createElement(s.Qr,{name:e.controllerName,control:e.control,render:function(n){var r,o,i=n.field,c=i.onChange,u=i.value,s=i.ref;return a().createElement(l.CtY,{titleText:e.title,name:e.name,control:e.control,controllerName:e.controllerName,id:e.name,size:"md",items:t||[],onChange:function(n){var t,r;null===(t=e.onSourceChange)||void 0===t||t.call(e,n.selectedItem),c(null===(r=n.selectedItem)||void 0===r?void 0:r.uuid)},initialSelectedItem:(null==t?void 0:t.find((function(n){var t;return n.uuid===(null===(t=e.row)||void 0===t?void 0:t.uuid)})))||{},itemToString:function(e){return e&&(null==e?void 0:e.name)?"".concat(null==e?void 0:e.name):""},shouldFilterItem:function(){return!0},value:null!==(o=null==t||null===(r=t.find((function(e){return e.uuid===u})))||void 0===r?void 0:r.name)&&void 0!==o?o:"",placeholder:e.placeholder,ref:s,invalid:e.invalid})}})};function ln(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function cn(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,o=[],i=!0,l=!1;try{for(t=t.call(e);!(i=(r=t.next()).done)&&(o.push(r.value),!n||o.length!==n);i=!0);}catch(e){l=!0,a=e}finally{try{i||null==t.return||t.return()}finally{if(l)throw a}}return o}}(e,n)||function(e,n){if(e){if("string"==typeof e)return ln(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?ln(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var un=t(826);function sn(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function dn(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){sn(e,n,t[n])}))}return e}function mn(e,n){return n=null!=n?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):function(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})),e}const pn=function(e){var n=e.stockItemUuid,t=(0,o.useTranslation)().t,i=function(e){var n=cn((0,r.useState)({startIndex:0,v:te._.Default,q:null,totalCount:!0}),2),t=n[0],a=n[1],o=cn((0,r.useState)(),2),i=o[0],l=o[1];(0,r.useEffect)((function(){a({startIndex:0,v:te._.Default,totalCount:!0,stockItemUuid:i})}),[i]);var c=(0,U.BU)(t),u=c.items,s=c.isLoading,d=c.error;return{items:u.results,totalCount:u.totalCount,isLoading:s,error:d,setStockItemUuid:l}}(),c=i.items,u=i.isLoading,d=i.setStockItemUuid;(0,r.useEffect)((function(){d(n)}),[n,d]);var m=(0,r.useMemo)((function(){return[{key:"source",header:t("source","Source"),styles:{width:"50%"}},{key:"code",header:t("code","Code"),styles:{width:"50%"}},{key:"action",header:t("action","Actions"),styles:{width:"50%"}}]}),[t]),p=(0,s.cI)({defaultValues:{},mode:"all",resolver:(0,h.F)(G)});return u?a().createElement(l.gqd,{showHeader:!1,rowCount:5,columnCount:5,zebra:!0}):a().createElement(s.RV,p,a().createElement(l.wQF,{rows:null!=c?c:[],headers:m,isSortable:!1,useZebraStyles:!0,render:function(e){var n=e.headers,t=e.getHeaderProps,r=e.getTableProps;return a().createElement(l.xJi,{className:an.referencesTableContainer},a().createElement(l.iA_,mn(dn({},r()),{className:an.referencesTable}),a().createElement(l.ssF,null,a().createElement(l.SCH,null,n.map((function(e){var n,r;return a().createElement(l.xDH,mn(dn({},t({header:e,isSortable:!1})),{style:e.styles,key:e.key}),null!==(r=null===(n=e.header)||void 0===n?void 0:n.content)&&void 0!==r?r:e.header)})),a().createElement(l.xDH,{style:{width:"70%"}}))),a().createElement(l.RMI,{className:an.referencesTableBody},null==c?void 0:c.map((function(e,n){return a().createElement(gn,{row:e,key:"".concat(n,"-").concat(null==e?void 0:e.uuid)})})),a().createElement(gn,{row:{},key:"bottom-row",isEditing:!0}))))}}),a().createElement(l.zxk,{name:"save",type:"submit",className:"submitButton",onClick:function(){var e=(0,p.getValues)(),r=e.code,a=e.references,o={referenceCode:r,stockItemUuid:n,stockSourceUuid:a};(0,U.C9)(o).then((function(){(0,A.d)("".concat(k.restBaseUrl,"/stockmanagement/stockitemreference")),(0,k.showSnackbar)({title:t("saveReferenceTitle","StockItem Reference"),subtitle:t("saveStockItemReferenceMessage","Stock Item Reference saved successfully"),kind:"success"})}),(function(e){(0,A.d)("".concat(k.restBaseUrl,"/stockmanagement/stockitemreference"));var n=(0,un.cK)(e);(0,k.showSnackbar)({title:t("saveStockItemReferenceErrorTitle","StockItem Reference"),subtitle:t("saveStockItemReferenceErrorMessage","Error saving stock item reference"+n.join(",")),kind:"error"})}))},kind:"primary",renderIcon:b.vc},t("save","Save")))};var gn=function(e){var n,t=e.isEditing,r=e.row,i=e.key,c=(0,o.useTranslation)().t,u=(0,s.Gc)().control;return a().createElement(l.SCH,null,a().createElement(l.pj1,null,t?a().createElement(on,{row:r,name:"references",controllerName:"references",control:u,placeholder:c("filter","Filter...")}):(!t||!r.uuid.startsWith("new-item"))&&(null==r?void 0:r.stockSourceName)),a().createElement(l.pj1,null,a().createElement("div",{className:an.referencesTableCell},a().createElement(ee,{id:"".concat(r.uuid,"-").concat(i),name:"code",control:u,size:"md",value:null!==(n=null==r?void 0:r.referenceCode)&&void 0!==n?n:"",controllerName:"code",labelText:""}),a().createElement(l.zxk,{type:"button",size:"sm",className:"submitButton clear-padding-margin",iconDescription:"Delete",kind:"ghost",renderIcon:Me.ZN,onClick:function(e){return function(e){e.preventDefault(),(0,U.sy)(r.uuid).then((function(){(0,k.showSnackbar)({title:c("deletePackagingUnitTitle","Delete StockItem reference"),kind:"success",subtitle:c("deleteStockItemReferenceMesaage","StockItem reference deleted Successfully")})}),(function(e){var n=(0,un.cK)(e);(0,k.showSnackbar)({title:c("deleteStockItemReferenceTitle","Error Deleting a stockitem reference"),kind:"error",subtitle:n.join(",")})}))}(e)}}))))},fn=t(8115),yn=t(8808);function vn(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function bn(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function hn(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){bn(e,n,t[n])}))}return e}function kn(e,n){return n=null!=n?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):function(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})),e}function Un(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,o=[],i=!0,l=!1;try{for(t=t.call(e);!(i=(r=t.next()).done)&&(o.push(r.value),!n||o.length!==n);i=!0);}catch(e){l=!0,a=e}finally{try{i||null==t.return||t.return()}finally{if(l)throw a}}return o}}(e,n)||function(e,n){if(e){if("string"==typeof e)return vn(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?vn(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const An=function(e){var n=e.columns,t=e.data,i=e.itemUuid,c=e.filter,u=(0,o.useTranslation)().t,s=(0,k.useConfig)().enablePrintButton,d=Un((0,r.useState)({startIndex:0,totalCount:!0,v:te._.Full,isPatientTransaction:"true"}),2),m=d[0],p=(d[1],Un((0,r.useState)({startIndex:0,v:(null==c?void 0:c.v)||te._.Default,limit:10,q:null==c?void 0:c.q,totalCount:!0}),2)),g=p[0],f=p[1],y=(0,U.GY)(i),v=y.item,b=y.isLoading,h=(0,U.O6)(m),A=h.items,S=h.isLoading,C=(h.error,(0,U.gT)(g).items),E=Un((0,r.useState)({}),2),_=E[0],w=E[1],O=Un((0,r.useState)(0),2),I=O[0],P=O[1];(0,r.useEffect)((function(){var e;(null==A||null===(e=A.results)||void 0===e?void 0:e.length)&&(P(0),w({}))}),[null==A?void 0:A.results]),(0,r.useEffect)((function(){var e,n=null==A||null===(e=A.results)||void 0===e?void 0:e[I];(null==n?void 0:n.stockItemUuid)&&f((function(e){return kn(hn({},e),{stockItemUuid:n.stockItemUuid})}))}),[I,A]),(0,r.useEffect)((function(){var e,n=null==A||null===(e=A.results)||void 0===e?void 0:e[I],t=null==n?void 0:n.stockItemUuid;(null==C?void 0:C.total)&&t&&(w((function(e){var r;return kn(hn({},e),bn({},t,{quantity:Number(C.total),itemName:null!==(r=n.packagingUomName)&&void 0!==r?r:""}))})),P((function(e){return e+1})))}),[C,I,A]);var N=(0,r.useMemo)((function(){var e,n;return null!==(n=null==A||null===(e=A.results)||void 0===e?void 0:e.map((function(e){var n,t,r=_[e.stockItemUuid];return kn(hn({},e),{balance:"".concat(null!==(n=null==r?void 0:r.quantity)&&void 0!==n?n:""," ").concat(null!==(t=null==r?void 0:r.itemName)&&void 0!==t?t:"")})})))&&void 0!==n?n:[]}),[null==A?void 0:A.results,_]),T=(0,r.useMemo)((function(){return[{key:"patientId",header:"Patient ID"},{key:"patientName",header:"Patient Name"},{key:"patientIdentifier",header:"Patient Identifier"},{key:"date",header:"Date"},{key:"location",header:"Location"},{key:"transaction",header:"Transaction"},{key:"balance",header:"Balance"},{key:"totalout",header:"OUT"},{key:"batch",header:"Batch"}]}),[]);return a().createElement(a().Fragment,null,s&&a().createElement(l.ZZf,{label:"Print"},a().createElement(l.sNh,{label:u("printStockCard","Print Stock Card"),renderIcon:function(e){return a().createElement(yn.FB,hn({size:24},e))},iconDescription:"Print Stock Card",onClick:function(){var e=(0,k.showModal)("transactions-print-stockcard-preview-modal",{onClose:function(){return e()},title:v.drugName||v.conceptName||"",columns:T,data:N})},disabled:b||S}),a().createElement(l.sNh,{label:u("printBinCard","Print Bin Card"),renderIcon:function(e){return a().createElement(yn.FB,hn({size:24},e))},iconDescription:"Print Bin Card",onClick:function(){var e=(0,k.showModal)("transactions-print-bincard-preview-modal",{onClose:function(){return e()},title:v.drugName||v.conceptName||"",columns:n,data:t})},disabled:b})))},Sn=function(e){(0,o.useTranslation)().t;var n=(0,d.O8)().stockLocations;return a().createElement(s.Qr,{name:e.controllerName,control:e.control,render:function(t){var r,o=t.field,i=o.onChange,c=o.value,u=o.ref;return a().createElement(l.CtY,{titleText:e.title,name:e.name,control:e.control,controllerName:e.controllerName,id:e.name,size:"md",items:null!=n?n:[],onChange:function(n){var t,r,a,o;null===(r=e.onLocationIdChange)||void 0===r||r.call(e,null!==(o=null==n||null===(t=n.selectedItem)||void 0===t?void 0:t.id)&&void 0!==o?o:""),i((null==n||null===(a=n.selectedItem)||void 0===a?void 0:a.name)||"")},initialSelectedItem:"".concat(null===(r=n[0])||void 0===r?void 0:r.name),itemToString:function(e){return e?e.name:""},shouldFilterItem:function(){return!0},placeholder:e.placeholder,ref:u,value:c,invalid:e.invalid,invalidText:e.invalidText})}})};function Cn(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function En(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,o=[],i=!0,l=!1;try{for(t=t.call(e);!(i=(r=t.next()).done)&&(o.push(r.value),!n||o.length!==n);i=!0);}catch(e){l=!0,a=e}finally{try{i||null==t.return||t.return()}finally{if(l)throw a}}return o}}(e,n)||function(e,n){if(e){if("string"==typeof e)return Cn(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Cn(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var _n=t(2840),wn=t(5048);const On=function(e){var n=e.operationNumber,t=e.operationUuid,i=(0,o.useTranslation)().t,c=(0,d.hE)(),u=c.types,s=c.isLoading,m=c.error,p=(0,wn.GM)(null!=t?t:null),g=p.items,f=p.error,y=p.isLoading,v=(0,r.useCallback)((function(){var e,n=null===(e=u.results)||void 0===e?void 0:e.find((function(e){return(null==e?void 0:e.uuid)===(null==g?void 0:g.operationTypeUuid)}));n&&(0,_n.gI)(i,n,g,null==g?void 0:g.requisitionStockOperationUuid)}),[g,i,u.results]);return(0,r.useEffect)((function(){f&&(0,k.showSnackbar)({title:i("errorLoadingStockOperation","Error loading stock operation"),subtitle:null==f?void 0:f.message,kind:"error"}),m&&(0,k.showSnackbar)({title:i("errorLoadingStockOperationTypes","Error loading stock operation types"),subtitle:null==m?void 0:m.message,kind:"error"})}),[f,m,i]),s||y?a().createElement(l.lSo,{description:i("loading","Loading")}):a().createElement("a",{onClick:v,style:{cursor:"pointer"}},n)};function In(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function Pn(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function Nn(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){Pn(e,n,t[n])}))}return e}function Tn(e,n){return n=null!=n?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):function(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t.push.apply(t,r)}return t}(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})),e}const jn=function(e){var n,t,u=e.stockItemUuid,d=(0,o.useTranslation)().t,m=(n=(0,r.useState)(),t=2,function(e){if(Array.isArray(e))return e}(n)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,o=[],i=!0,l=!1;try{for(t=t.call(e);!(i=(r=t.next()).done)&&(o.push(r.value),!n||o.length!==n);i=!0);}catch(e){l=!0,a=e}finally{try{i||null==t.return||t.return()}finally{if(l)throw a}}return o}}(n,t)||function(e,n){if(e){if("string"==typeof e)return In(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?In(e,n):void 0}}(n,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),p=m[0],g=m[1],f=function(e){var n=En((0,r.useState)({startIndex:0,v:(null==e?void 0:e.v)||te._.Default,limit:10,q:null==e?void 0:e.q,totalCount:!0}),2),t=n[0],a=n[1],o=En((0,r.useState)(10),2),i=o[0],l=o[1],c=En((0,r.useState)(null),2),u=c[0],s=c[1],d=En((0,r.useState)(1),2),m=d[0],p=d[1],g=En((0,r.useState)(null==e?void 0:e.stockItemUuid),2),f=g[0],y=g[1],v=En((0,r.useState)(null==e?void 0:e.partyUuid),2),b=v[0],h=v[1],k=En((0,r.useState)(null==e?void 0:e.locationUuid),2),A=k[0],S=k[1],C=En((0,r.useState)(null==e?void 0:e.stockBatchUuid),2),E=C[0],_=C[1];(0,r.useEffect)((function(){a({startIndex:m-1,v:te._.Default,limit:i,q:u,totalCount:!0,stockItemUuid:f,partyUuid:b,locationUuid:A,stockBatchUuid:E})}),[u,m,i,f,b,A,E]);var w=(0,U.O6)(t),O=w.items,I=w.isLoading,P=w.error,N=(0,U.gT)(t).items,T=(0,r.useMemo)((function(){return[{key:"date",header:"Date"},{key:"location",header:"Location"},{key:"transaction",header:"Transaction"},{key:"in",header:"IN"},{key:"out",header:"OUT"},{key:"batch",header:"Batch"},{key:"reference",header:"Reference"},{key:"status",header:"Status"}]}),[]),j=(0,r.useMemo)((function(){return[{key:"date",header:"Date"},{key:"location",header:"Location"},{key:"transaction",header:"Transaction"},{key:"totalin",header:"IN"},{key:"totalout",header:"OUT"},{key:"batch",header:"Batch"},{key:"balance",header:"Balance"},{key:"reference",header:"Reference"},{key:"status",header:"Status"}]}),[]);return{items:O.results,totalCount:O.totalCount,currentPage:m,currentPageSize:i,setCurrentPage:p,setPageSize:l,pageSizes:[10,20,30,40,50],isLoading:I,error:P,setSearchString:s,tableHeaders:T,setStockItemUuid:y,setLocationUuid:S,setPartyUuid:h,setStockBatchUuid:_,binCardHeaders:j,inventory:N}}(p),y=f.isLoading,v=f.items,b=f.tableHeaders,h=f.totalCount,k=f.setCurrentPage,A=f.setStockItemUuid,S=f.setLocationUuid,C=f.binCardHeaders,E=f.inventory;(0,r.useEffect)((function(){A(u)}),[u,A]);var _=(0,s.cI)({}).control,w=(0,r.useMemo)((function(){return null==v?void 0:v.map((function(e){var n,t,r,o,l,c,u,s,d,m=null!==(o=null==E?void 0:E.total)&&void 0!==o?o:"";return Tn(Nn({},e),{id:null==e?void 0:e.uuid,key:"key-".concat(null==e?void 0:e.uuid),uuid:"".concat(null==e?void 0:e.uuid),date:(0,i.up)(null==e?void 0:e.dateCreated),location:e.operationSourcePartyName&&e.operationDestinationPartyName?e.operationSourcePartyName===(null==e?void 0:e.partyName)?(e.quantity,a().createElement(a().Fragment,null,a().createElement("span",{className:"transaction-location"},e.operationSourcePartyName),a().createElement(fn.Xd,{size:16})," ",e.operationDestinationPartyName)):e.operationDestinationPartyName===(null==e?void 0:e.partyName)?(e.quantity,a().createElement(a().Fragment,null,a().createElement("span",{className:"transaction-location"},e.operationDestinationPartyName),a().createElement(fn.Xd,{size:16})," ",e.operationSourcePartyName)):null==e?void 0:e.partyName:null==e?void 0:e.partyName,transaction:(null==e?void 0:e.isPatientTransaction)?"Patient Dispense":e.stockOperationTypeName,quantity:"".concat(null==e||null===(n=e.quantity)||void 0===n?void 0:n.toLocaleString()," ").concat(null!==(l=null==e?void 0:e.packagingUomName)&&void 0!==l?l:""),batch:e.stockBatchNo?"".concat(e.stockBatchNo).concat(e.expiration?" (".concat((0,i.up)(e.expiration),")"):""):"",reference:a().createElement(On,{operationUuid:null==e?void 0:e.stockOperationUuid,operationNumber:null==e?void 0:e.stockOperationNumber}),status:null!==(c=null==e?void 0:e.stockOperationStatus)&&void 0!==c?c:"",in:(null==e?void 0:e.quantity)>=0?"".concat(null==e||null===(t=e.quantity)||void 0===t?void 0:t.toLocaleString()," ").concat(null!==(u=null==e?void 0:e.packagingUomName)&&void 0!==u?u:""," of ").concat(e.packagingUomFactor):"",out:(null==e?void 0:e.quantity)<0?"".concat(null===(r=-1*(null==e?void 0:e.quantity))||void 0===r?void 0:r.toLocaleString()," ").concat(null!==(s=null==e?void 0:e.packagingUomName)&&void 0!==s?s:""," of ").concat(e.packagingUomFactor):"",totalin:(null==e?void 0:e.quantity)>=0?"".concat((null==e?void 0:e.quantity)*Number(e.packagingUomFactor)):"",totalout:(null==e?void 0:e.quantity)<0?"".concat(-1*(null==e?void 0:e.quantity)*Number(e.packagingUomFactor)):"",balance:"".concat(m," ").concat(null!==(d=null==e?void 0:e.packagingUomName)&&void 0!==d?d:"")})}))}),[v,E]);return y?a().createElement(l.gqd,{role:"progressbar"}):a().createElement(c.Z,{children:function(){return a().createElement(a().Fragment,null,a().createElement(An,{columns:C,data:w,itemUuid:u,filter:p}),a().createElement(Sn,{onLocationIdChange:function(e){S(e),g(Tn(Nn({},p),{locationUuid:e}))},name:"TransactionLocationUuid",placeholder:d("filterByLocation","Filter by Location"),control:_,controllerName:"TransactionLocationUuid"}))},columns:b,data:w,totalItems:h,goToPage:k,hasToolbar:!0})};function xn(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}const Dn=function(e){var n,t,i=e.stockItem,l=e.closeWorkspace,c=(0,o.useTranslation)().t,u=(n=(0,r.useState)(0),t=2,function(e){if(Array.isArray(e))return e}(n)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,o=[],i=!0,l=!1;try{for(t=t.call(e);!(i=(r=t.next()).done)&&(o.push(r.value),!n||o.length!==n);i=!0);}catch(e){l=!0,a=e}finally{try{i||null==t.return||t.return()}finally{if(l)throw a}}return o}}(n,t)||function(e,n){if(e){if("string"==typeof e)return xn(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?xn(e,n):void 0}}(n,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=u[0],d=u[1],m=Boolean(i),p=function(e){d(e)},g=[{name:c("stockItemDetails","Stock Item Details"),component:a().createElement(Pe,{handleTabChange:p,stockItem:i,onCloseWorkspace:l})},{name:c("packagingUnits","Packaging Units"),component:a().createElement($,{isEditing:!0,handleTabChange:p,stockItemUuid:null==i?void 0:i.uuid}),disabled:!m},{name:c("transactions","Transactions"),component:a().createElement(jn,{stockItemUuid:null==i?void 0:i.uuid}),disabled:!m},{name:c("batchInformation","Batch Information"),component:a().createElement(v,{stockItemUuid:null==i?void 0:i.uuid}),disabled:!m},{name:c("quantities","Quantities"),component:a().createElement(nn,{stockItemUuid:null==i?void 0:i.uuid}),disabled:!m},{name:c("stockRules","Rules"),component:a().createElement(We,{stockItemUuid:null==i?void 0:i.uuid}),disabled:!m},{name:c("references","References"),component:a().createElement(pn,{stockItemUuid:null==i?void 0:i.uuid,isEditing:m}),disabled:!m}];return a().createElement(Ke.Z,{steps:g.map((function(e,n){return{title:e.name,component:e.component,disabled:e.disabled}})),selectedIndex:s,onChange:p})}},9462:(e,n,t)=>{t.d(n,{z:()=>c});var r=t(2484),a=t(1672),o=t(3566);function i(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function l(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,o=[],i=!0,l=!1;try{for(t=t.call(e);!(i=(r=t.next()).done)&&(o.push(r.value),!n||o.length!==n);i=!0);}catch(e){l=!0,a=e}finally{try{i||null==t.return||t.return()}finally{if(l)throw a}}return o}}(e,n)||function(e,n){if(e){if("string"==typeof e)return i(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?i(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e){var n=l((0,a.useState)({startIndex:0,v:e||r._.Default,q:null,totalCount:!0}),2),t=n[0],i=n[1],c=l((0,a.useState)(),2),u=c[0],s=c[1];(0,a.useEffect)((function(){i({startIndex:0,v:r._.Default,totalCount:!0,stockItemUuid:u})}),[u]);var d,m=(0,o.Yf)(t),p=m.items,g=m.isLoading,f=m.error,y=m.mutate;return{items:null!==(d=p.results)&&void 0!==d?d:[],totalCount:p.totalCount,isLoading:g,error:f,setStockItemUuid:s,mutate:y}}},2400:(e,n,t)=>{t.d(n,{eD:()=>u,yf:()=>c});var r=t(3775),a=t(2484),o=t(5494);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){i(e,n,t[n])}))}return e}function c(e){var n="".concat(r.restBaseUrl,"/stockmanagement/stockrule").concat((0,a.m)(e)),t=(0,o.ZP)(n,r.openmrsFetch),i=t.data,l=t.error,c=t.isLoading;return{items:(null==i?void 0:i.data)||{},isLoading:c,error:l}}function u(e){var n=null!=e.uuid,t="".concat(r.restBaseUrl,"/stockmanagement/stockrule").concat(n?"/"+e.uuid:""),a=new AbortController;return(0,r.openmrsFetch)(t,{method:"POST",headers:{"Content-Type":"application/json"},signal:a.signal,body:l({},e)})}}}]);