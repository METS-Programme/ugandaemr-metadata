/*! For license information please see 4605.js.LICENSE.txt */
"use strict";(globalThis.webpackChunk_openmrs_esm_patient_attachments_app=globalThis.webpackChunk_openmrs_esm_patient_attachments_app||[]).push([[4605],{3296:(t,e,r)=>{var n=r(5641),o="function"==typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t==1/e)||t!=t&&e!=e},i=n.useState,u=n.useEffect,a=n.useLayoutEffect,c=n.useDebugValue;function s(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!o(t,r)}catch(t){return!0}}var f="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(t,e){return e()}:function(t,e){var r=e(),n=i({inst:{value:r,getSnapshot:e}}),o=n[0].inst,f=n[1];return a((function(){o.value=r,o.getSnapshot=e,s(o)&&f({inst:o})}),[t,r,e]),u((function(){return s(o)&&f({inst:o}),t((function(){s(o)&&f({inst:o})}))}),[t]),c(r),r};e.useSyncExternalStore=void 0!==n.useSyncExternalStore?n.useSyncExternalStore:f},8139:(t,e,r)=>{t.exports=r(3296)},3375:(t,e,r)=>{var n;r.d(e,{A:()=>f});var o=new Uint8Array(16);function i(){if(!n&&!(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(o)}const u=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var a=[],c=0;c<256;++c)a.push((c+256).toString(16).substr(1));const s=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(a[t[e+0]]+a[t[e+1]]+a[t[e+2]]+a[t[e+3]]+"-"+a[t[e+4]]+a[t[e+5]]+"-"+a[t[e+6]]+a[t[e+7]]+"-"+a[t[e+8]]+a[t[e+9]]+"-"+a[t[e+10]]+a[t[e+11]]+a[t[e+12]]+a[t[e+13]]+a[t[e+14]]+a[t[e+15]]).toLowerCase();if(!function(t){return"string"==typeof t&&u.test(t)}(r))throw TypeError("Stringified UUID is invalid");return r},f=function(t,e,r){var n=(t=t||{}).random||(t.rng||i)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,e){r=r||0;for(var o=0;o<16;++o)e[r+o]=n[o];return e}return s(n)}},4441:(t,e,r)=>{r.d(e,{A:()=>n});const n=function(t){var e=null==t?0:t.length;return e?t[e-1]:void 0}},3537:(t,e,r)=>{r.d(e,{A:()=>Ce});const n=function(t,e){return t===e||t!=t&&e!=e},o=function(t,e){for(var r=t.length;r--;)if(n(t[r][0],e))return r;return-1};var i=Array.prototype.splice;function u(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}u.prototype.clear=function(){this.__data__=[],this.size=0},u.prototype.delete=function(t){var e=this.__data__,r=o(e,t);return!(r<0||(r==e.length-1?e.pop():i.call(e,r,1),--this.size,0))},u.prototype.get=function(t){var e=this.__data__,r=o(e,t);return r<0?void 0:e[r][1]},u.prototype.has=function(t){return o(this.__data__,t)>-1},u.prototype.set=function(t,e){var r=this.__data__,n=o(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};const a=u,c="object"==typeof global&&global&&global.Object===Object&&global;var s="object"==typeof self&&self&&self.Object===Object&&self;const f=c||s||Function("return this")(),l=f.Symbol;var d=Object.prototype,p=d.hasOwnProperty,v=d.toString,h=l?l.toStringTag:void 0;var y=Object.prototype.toString;var b=l?l.toStringTag:void 0;const _=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":b&&b in Object(t)?function(t){var e=p.call(t,h),r=t[h];try{t[h]=void 0;var n=!0}catch(t){}var o=v.call(t);return n&&(e?t[h]=r:delete t[h]),o}(t):function(t){return y.call(t)}(t)},g=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},j=function(t){if(!g(t))return!1;var e=_(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},m=f["__core-js_shared__"];var w,E=(w=/[^.]+$/.exec(m&&m.keys&&m.keys.IE_PROTO||""))?"Symbol(src)_1."+w:"";var O=Function.prototype.toString;const S=function(t){if(null!=t){try{return O.call(t)}catch(t){}try{return t+""}catch(t){}}return""};var A=/^\[object .+?Constructor\]$/,R=Function.prototype,U=Object.prototype,T=R.toString,V=U.hasOwnProperty,C=RegExp("^"+T.call(V).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const z=function(t){return!(!g(t)||(e=t,E&&E in e))&&(j(t)?C:A).test(S(t));var e},k=function(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return z(r)?r:void 0},L=k(f,"Map"),I=k(Object,"create");var x=Object.prototype.hasOwnProperty;var P=Object.prototype.hasOwnProperty;function D(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}D.prototype.clear=function(){this.__data__=I?I(null):{},this.size=0},D.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},D.prototype.get=function(t){var e=this.__data__;if(I){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return x.call(e,t)?e[t]:void 0},D.prototype.has=function(t){var e=this.__data__;return I?void 0!==e[t]:P.call(e,t)},D.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=I&&void 0===e?"__lodash_hash_undefined__":e,this};const F=D,N=function(t,e){var r,n,o=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?o["string"==typeof e?"string":"hash"]:o.map};function M(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}M.prototype.clear=function(){this.size=0,this.__data__={hash:new F,map:new(L||a),string:new F}},M.prototype.delete=function(t){var e=N(this,t).delete(t);return this.size-=e?1:0,e},M.prototype.get=function(t){return N(this,t).get(t)},M.prototype.has=function(t){return N(this,t).has(t)},M.prototype.set=function(t,e){var r=N(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};const $=M;function B(t){var e=this.__data__=new a(t);this.size=e.size}B.prototype.clear=function(){this.__data__=new a,this.size=0},B.prototype.delete=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r},B.prototype.get=function(t){return this.__data__.get(t)},B.prototype.has=function(t){return this.__data__.has(t)},B.prototype.set=function(t,e){var r=this.__data__;if(r instanceof a){var n=r.__data__;if(!L||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new $(n)}return r.set(t,e),this.size=r.size,this};const W=B;function G(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new $;++e<r;)this.add(t[e])}G.prototype.add=G.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},G.prototype.has=function(t){return this.__data__.has(t)};const q=G,H=function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1},Y=function(t,e){return t.has(e)},J=function(t,e,r,n,o,i){var u=1&r,a=t.length,c=e.length;if(a!=c&&!(u&&c>a))return!1;var s=i.get(t),f=i.get(e);if(s&&f)return s==e&&f==t;var l=-1,d=!0,p=2&r?new q:void 0;for(i.set(t,e),i.set(e,t);++l<a;){var v=t[l],h=e[l];if(n)var y=u?n(h,v,l,e,t,i):n(v,h,l,t,e,i);if(void 0!==y){if(y)continue;d=!1;break}if(p){if(!H(e,(function(t,e){if(!Y(p,e)&&(v===t||o(v,t,r,n,i)))return p.push(e)}))){d=!1;break}}else if(v!==h&&!o(v,h,r,n,i)){d=!1;break}}return i.delete(t),i.delete(e),d},X=f.Uint8Array,K=function(t){var e=-1,r=Array(t.size);return t.forEach((function(t,n){r[++e]=[n,t]})),r},Q=function(t){var e=-1,r=Array(t.size);return t.forEach((function(t){r[++e]=t})),r};var Z=l?l.prototype:void 0,tt=Z?Z.valueOf:void 0;const et=Array.isArray;var rt=Object.prototype.propertyIsEnumerable,nt=Object.getOwnPropertySymbols;const ot=nt?function(t){return null==t?[]:(t=Object(t),function(t,e){for(var r=-1,n=null==t?0:t.length,o=0,i=[];++r<n;){var u=t[r];e(u,r,t)&&(i[o++]=u)}return i}(nt(t),(function(e){return rt.call(t,e)})))}:function(){return[]},it=function(t){return null!=t&&"object"==typeof t},ut=function(t){return it(t)&&"[object Arguments]"==_(t)};var at=Object.prototype,ct=at.hasOwnProperty,st=at.propertyIsEnumerable;const ft=ut(function(){return arguments}())?ut:function(t){return it(t)&&ct.call(t,"callee")&&!st.call(t,"callee")};var lt="object"==typeof exports&&exports&&!exports.nodeType&&exports,dt=lt&&"object"==typeof module&&module&&!module.nodeType&&module,pt=dt&&dt.exports===lt?f.Buffer:void 0;const vt=(pt?pt.isBuffer:void 0)||function(){return!1};var ht=/^(?:0|[1-9]\d*)$/;const yt=function(t,e){var r=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&ht.test(t))&&t>-1&&t%1==0&&t<e},bt=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991};var _t={};_t["[object Float32Array]"]=_t["[object Float64Array]"]=_t["[object Int8Array]"]=_t["[object Int16Array]"]=_t["[object Int32Array]"]=_t["[object Uint8Array]"]=_t["[object Uint8ClampedArray]"]=_t["[object Uint16Array]"]=_t["[object Uint32Array]"]=!0,_t["[object Arguments]"]=_t["[object Array]"]=_t["[object ArrayBuffer]"]=_t["[object Boolean]"]=_t["[object DataView]"]=_t["[object Date]"]=_t["[object Error]"]=_t["[object Function]"]=_t["[object Map]"]=_t["[object Number]"]=_t["[object Object]"]=_t["[object RegExp]"]=_t["[object Set]"]=_t["[object String]"]=_t["[object WeakMap]"]=!1;var gt="object"==typeof exports&&exports&&!exports.nodeType&&exports,jt=gt&&"object"==typeof module&&module&&!module.nodeType&&module,mt=jt&&jt.exports===gt&&c.process,wt=function(){try{return jt&&jt.require&&jt.require("util").types||mt&&mt.binding&&mt.binding("util")}catch(t){}}(),Et=wt&&wt.isTypedArray;const Ot=Et?(St=Et,function(t){return St(t)}):function(t){return it(t)&&bt(t.length)&&!!_t[_(t)]};var St,At=Object.prototype.hasOwnProperty;const Rt=function(t,e){var r=et(t),n=!r&&ft(t),o=!r&&!n&&vt(t),i=!r&&!n&&!o&&Ot(t),u=r||n||o||i,a=u?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],c=a.length;for(var s in t)!e&&!At.call(t,s)||u&&("length"==s||o&&("offset"==s||"parent"==s)||i&&("buffer"==s||"byteLength"==s||"byteOffset"==s)||yt(s,c))||a.push(s);return a};var Ut=Object.prototype;const Tt=function(t,e){return function(r){return t(e(r))}}(Object.keys,Object);var Vt=Object.prototype.hasOwnProperty;const Ct=function(t){if(r=(e=t)&&e.constructor,e!==("function"==typeof r&&r.prototype||Ut))return Tt(t);var e,r,n=[];for(var o in Object(t))Vt.call(t,o)&&"constructor"!=o&&n.push(o);return n},zt=function(t){return null!=(e=t)&&bt(e.length)&&!j(e)?Rt(t):Ct(t);var e},kt=function(t){return function(t,e,r){var n=e(t);return et(t)?n:function(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t}(n,r(t))}(t,zt,ot)};var Lt=Object.prototype.hasOwnProperty;const It=k(f,"DataView"),xt=k(f,"Promise"),Pt=k(f,"Set"),Dt=k(f,"WeakMap");var Ft="[object Map]",Nt="[object Promise]",Mt="[object Set]",$t="[object WeakMap]",Bt="[object DataView]",Wt=S(It),Gt=S(L),qt=S(xt),Ht=S(Pt),Yt=S(Dt),Jt=_;(It&&Jt(new It(new ArrayBuffer(1)))!=Bt||L&&Jt(new L)!=Ft||xt&&Jt(xt.resolve())!=Nt||Pt&&Jt(new Pt)!=Mt||Dt&&Jt(new Dt)!=$t)&&(Jt=function(t){var e=_(t),r="[object Object]"==e?t.constructor:void 0,n=r?S(r):"";if(n)switch(n){case Wt:return Bt;case Gt:return Ft;case qt:return Nt;case Ht:return Mt;case Yt:return $t}return e});const Xt=Jt;var Kt="[object Arguments]",Qt="[object Array]",Zt="[object Object]",te=Object.prototype.hasOwnProperty;const ee=function(t,e,r,o,i,u){var a=et(t),c=et(e),s=a?Qt:Xt(t),f=c?Qt:Xt(e),l=(s=s==Kt?Zt:s)==Zt,d=(f=f==Kt?Zt:f)==Zt,p=s==f;if(p&&vt(t)){if(!vt(e))return!1;a=!0,l=!1}if(p&&!l)return u||(u=new W),a||Ot(t)?J(t,e,r,o,i,u):function(t,e,r,o,i,u,a){switch(r){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!u(new X(t),new X(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return n(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var c=K;case"[object Set]":var s=1&o;if(c||(c=Q),t.size!=e.size&&!s)return!1;var f=a.get(t);if(f)return f==e;o|=2,a.set(t,e);var l=J(c(t),c(e),o,i,u,a);return a.delete(t),l;case"[object Symbol]":if(tt)return tt.call(t)==tt.call(e)}return!1}(t,e,s,r,o,i,u);if(!(1&r)){var v=l&&te.call(t,"__wrapped__"),h=d&&te.call(e,"__wrapped__");if(v||h){var y=v?t.value():t,b=h?e.value():e;return u||(u=new W),i(y,b,r,o,u)}}return!!p&&(u||(u=new W),function(t,e,r,n,o,i){var u=1&r,a=kt(t),c=a.length;if(c!=kt(e).length&&!u)return!1;for(var s=c;s--;){var f=a[s];if(!(u?f in e:Lt.call(e,f)))return!1}var l=i.get(t),d=i.get(e);if(l&&d)return l==e&&d==t;var p=!0;i.set(t,e),i.set(e,t);for(var v=u;++s<c;){var h=t[f=a[s]],y=e[f];if(n)var b=u?n(y,h,f,e,t,i):n(h,y,f,t,e,i);if(!(void 0===b?h===y||o(h,y,r,n,i):b)){p=!1;break}v||(v="constructor"==f)}if(p&&!v){var _=t.constructor,g=e.constructor;_==g||!("constructor"in t)||!("constructor"in e)||"function"==typeof _&&_ instanceof _&&"function"==typeof g&&g instanceof g||(p=!1)}return i.delete(t),i.delete(e),p}(t,e,r,o,i,u))},re=function t(e,r,n,o,i){return e===r||(null==e||null==r||!it(e)&&!it(r)?e!=e&&r!=r:ee(e,r,n,o,t,i))},ne=function(t){return t==t&&!g(t)},oe=function(t,e){return function(r){return null!=r&&r[t]===e&&(void 0!==e||t in Object(r))}},ie=function(t){var e=function(t){for(var e=zt(t),r=e.length;r--;){var n=e[r],o=t[n];e[r]=[n,o,ne(o)]}return e}(t);return 1==e.length&&e[0][2]?oe(e[0][0],e[0][1]):function(r){return r===t||function(t,e,r,n){var o=r.length,i=o,u=!n;if(null==t)return!i;for(t=Object(t);o--;){var a=r[o];if(u&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++o<i;){var c=(a=r[o])[0],s=t[c],f=a[1];if(u&&a[2]){if(void 0===s&&!(c in t))return!1}else{var l=new W;if(n)var d=n(s,f,c,t,e,l);if(!(void 0===d?re(f,s,3,n,l):d))return!1}}return!0}(r,t,e)}},ue=function(t){return"symbol"==typeof t||it(t)&&"[object Symbol]"==_(t)};var ae=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ce=/^\w*$/;const se=function(t,e){if(et(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!ue(t))||ce.test(t)||!ae.test(t)||null!=e&&t in Object(e)};function fe(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var u=t.apply(this,n);return r.cache=i.set(o,u)||i,u};return r.cache=new(fe.Cache||$),r}fe.Cache=$;var le=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,de=/\\(\\)?/g;const pe=(ve=fe((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(le,(function(t,r,n,o){e.push(n?o.replace(de,"$1"):r||t)})),e}),(function(t){return 500===he.size&&he.clear(),t})),he=ve.cache,ve);var ve,he;var ye=l?l.prototype:void 0,be=ye?ye.toString:void 0;const _e=function t(e){if("string"==typeof e)return e;if(et(e))return function(t,e){for(var r=-1,n=null==t?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o}(e,t)+"";if(ue(e))return be?be.call(e):"";var r=e+"";return"0"==r&&1/e==-1/0?"-0":r},ge=function(t,e){return et(t)?t:se(t,e)?[t]:pe(function(t){return null==t?"":_e(t)}(t))},je=function(t){if("string"==typeof t||ue(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e},me=function(t,e){for(var r=0,n=(e=ge(e,t)).length;null!=t&&r<n;)t=t[je(e[r++])];return r&&r==n?t:void 0},we=function(t,e){return null!=t&&e in Object(t)},Ee=function(t,e){return null!=t&&function(t,e,r){for(var n=-1,o=(e=ge(e,t)).length,i=!1;++n<o;){var u=je(e[n]);if(!(i=null!=t&&r(t,u)))break;t=t[u]}return i||++n!=o?i:!!(o=null==t?0:t.length)&&bt(o)&&yt(u,o)&&(et(t)||ft(t))}(t,e,we)},Oe=function(t,e){return se(t)&&ne(e)?oe(je(t),e):function(r){var n=function(t,e,r){var n=null==t?void 0:me(t,e);return void 0===n?r:n}(r,t);return void 0===n&&n===e?Ee(r,t):re(e,n,3)}},Se=function(t){return t},Ae=function(t){return se(t)?(e=je(t),function(t){return null==t?void 0:t[e]}):function(t){return function(e){return me(e,t)}}(t);var e},Re=function(t){return t!=t},Ue=function(t,e){return!(null==t||!t.length)&&function(t,e,r){return e==e?function(t,e,r){for(var n=r-1,o=t.length;++n<o;)if(t[n]===e)return n;return-1}(t,e,r):function(t,e,r,n){for(var o=t.length,i=r+(n?1:-1);n?i--:++i<o;)if(e(t[i],i,t))return i;return-1}(t,Re,r)}(t,e,0)>-1},Te=function(t,e,r){for(var n=-1,o=null==t?0:t.length;++n<o;)if(r(e,t[n]))return!0;return!1},Ve=Pt&&1/Q(new Pt([,-0]))[1]==1/0?function(t){return new Pt(t)}:function(){},Ce=function(t,e){return t&&t.length?function(t,e,r){var n=-1,o=Ue,i=t.length,u=!0,a=[],c=a;if(r)u=!1,o=Te;else if(i>=200){var s=e?null:Ve(t);if(s)return Q(s);u=!1,o=Y,c=new q}else c=e?[]:a;t:for(;++n<i;){var f=t[n],l=e?e(f):f;if(f=r||0!==f?f:0,u&&l==l){for(var d=c.length;d--;)if(c[d]===l)continue t;e&&c.push(l),a.push(f)}else o(c,l,r)||(c!==a&&c.push(l),a.push(f))}return a}(t,"function"==typeof(r=e)?r:null==r?Se:"object"==typeof r?et(r)?Oe(r[0],r[1]):ie(r):Ae(r)):[];var r}},1123:(t,e,r)=>{r.d(e,{Ay:()=>c,iX:()=>i.useSWRConfig});var n=r(5641),o=r(8139),i=r(5434);const u=n.use||(t=>{if("pending"===t.status)throw t;if("fulfilled"===t.status)return t.value;throw"rejected"===t.status?t.reason:(t.status="pending",t.then((e=>{t.status="fulfilled",t.value=e}),(e=>{t.status="rejected",t.reason=e})),t)}),a={dedupe:!0},c=(i.OBJECT.defineProperty(i.SWRConfig,"defaultValue",{value:i.defaultConfig}),(0,i.withArgs)(((t,e,r)=>{const{cache:c,compare:s,suspense:f,fallbackData:l,revalidateOnMount:d,revalidateIfStale:p,refreshInterval:v,refreshWhenHidden:h,refreshWhenOffline:y,keepPreviousData:b}=r,[_,g,j,m]=i.SWRGlobalState.get(c),[w,E]=(0,i.serialize)(t),O=(0,n.useRef)(!1),S=(0,n.useRef)(!1),A=(0,n.useRef)(w),R=(0,n.useRef)(e),U=(0,n.useRef)(r),T=()=>U.current,V=()=>T().isVisible()&&T().isOnline(),[C,z,k,L]=(0,i.createCacheHelper)(c,w),I=(0,n.useRef)({}).current,x=(0,i.isUndefined)(l)?r.fallback[w]:l,P=(t,e)=>{for(const r in I){const n=r;if("data"===n){if(!s(t[n],e[n])){if(!(0,i.isUndefined)(t[n]))return!1;if(!s(q,e[n]))return!1}}else if(e[n]!==t[n])return!1}return!0},D=(0,n.useMemo)((()=>{const t=!!w&&!!e&&((0,i.isUndefined)(d)?!T().isPaused()&&!f&&(!!(0,i.isUndefined)(p)||p):d),r=e=>{const r=(0,i.mergeObjects)(e);return delete r._k,t?{isValidating:!0,isLoading:!0,...r}:r},n=C(),o=L(),u=r(n),a=n===o?u:r(o);let c=u;return[()=>{const t=r(C());return P(t,c)?(c.data=t.data,c.isLoading=t.isLoading,c.isValidating=t.isValidating,c.error=t.error,c):(c=t,t)},()=>a]}),[c,w]),F=(0,o.useSyncExternalStore)((0,n.useCallback)((t=>k(w,((e,r)=>{P(r,e)||t()}))),[c,w]),D[0],D[1]),N=!O.current,M=_[w]&&_[w].length>0,$=F.data,B=(0,i.isUndefined)($)?x:$,W=F.error,G=(0,n.useRef)(B),q=b?(0,i.isUndefined)($)?G.current:$:B,H=!(M&&!(0,i.isUndefined)(W))&&(N&&!(0,i.isUndefined)(d)?d:!T().isPaused()&&(f?!(0,i.isUndefined)(B)&&p:(0,i.isUndefined)(B)||p)),Y=!!(w&&e&&N&&H),J=(0,i.isUndefined)(F.isValidating)?Y:F.isValidating,X=(0,i.isUndefined)(F.isLoading)?Y:F.isLoading,K=(0,n.useCallback)((async t=>{const e=R.current;if(!w||!e||S.current||T().isPaused())return!1;let n,o,u=!0;const a=t||{},c=!j[w]||!a.dedupe,f=()=>i.IS_REACT_LEGACY?!S.current&&w===A.current&&O.current:w===A.current,l={isValidating:!1,isLoading:!1},d=()=>{z(l)},p=()=>{const t=j[w];t&&t[1]===o&&delete j[w]},v={isValidating:!0};(0,i.isUndefined)(C().data)&&(v.isLoading=!0);try{if(c&&(z(v),r.loadingTimeout&&(0,i.isUndefined)(C().data)&&setTimeout((()=>{u&&f()&&T().onLoadingSlow(w,r)}),r.loadingTimeout),j[w]=[e(E),(0,i.getTimestamp)()]),[n,o]=j[w],n=await n,c&&setTimeout(p,r.dedupingInterval),!j[w]||j[w][1]!==o)return c&&f()&&T().onDiscarded(w),!1;l.error=i.UNDEFINED;const t=g[w];if(!(0,i.isUndefined)(t)&&(o<=t[0]||o<=t[1]||0===t[1]))return d(),c&&f()&&T().onDiscarded(w),!1;const a=C().data;l.data=s(a,n)?a:n,c&&f()&&T().onSuccess(n,w,r)}catch(t){p();const e=T(),{shouldRetryOnError:r}=e;e.isPaused()||(l.error=t,c&&f()&&(e.onError(t,w,e),(!0===r||(0,i.isFunction)(r)&&r(t))&&(T().revalidateOnFocus&&T().revalidateOnReconnect&&!V()||e.onErrorRetry(t,w,e,(t=>{const e=_[w];e&&e[0]&&e[0](i.revalidateEvents.ERROR_REVALIDATE_EVENT,t)}),{retryCount:(a.retryCount||0)+1,dedupe:!0}))))}return u=!1,d(),!0}),[w,c]),Q=(0,n.useCallback)(((...t)=>(0,i.internalMutate)(c,A.current,...t)),[]);if((0,i.useIsomorphicLayoutEffect)((()=>{R.current=e,U.current=r,(0,i.isUndefined)($)||(G.current=$)})),(0,i.useIsomorphicLayoutEffect)((()=>{if(!w)return;const t=K.bind(i.UNDEFINED,a);let e=0;const r=(0,i.subscribeCallback)(w,_,((r,n={})=>{if(r==i.revalidateEvents.FOCUS_EVENT){const r=Date.now();T().revalidateOnFocus&&r>e&&V()&&(e=r+T().focusThrottleInterval,t())}else if(r==i.revalidateEvents.RECONNECT_EVENT)T().revalidateOnReconnect&&V()&&t();else{if(r==i.revalidateEvents.MUTATE_EVENT)return K();if(r==i.revalidateEvents.ERROR_REVALIDATE_EVENT)return K(n)}}));return S.current=!1,A.current=w,O.current=!0,z({_k:E}),H&&((0,i.isUndefined)(B)||i.IS_SERVER?t():(0,i.rAF)(t)),()=>{S.current=!0,r()}}),[w]),(0,i.useIsomorphicLayoutEffect)((()=>{let t;function e(){const e=(0,i.isFunction)(v)?v(C().data):v;e&&-1!==t&&(t=setTimeout(r,e))}function r(){C().error||!h&&!T().isVisible()||!y&&!T().isOnline()?e():K(a).then(e)}return e(),()=>{t&&(clearTimeout(t),t=-1)}}),[v,h,y,w]),(0,n.useDebugValue)(q),f&&(0,i.isUndefined)(B)&&w){if(!i.IS_REACT_LEGACY&&i.IS_SERVER)throw new Error("Fallback data is required when using suspense in SSR.");R.current=e,U.current=r,S.current=!1;const t=m[w];if(!(0,i.isUndefined)(t)){const e=Q(t);u(e)}if(!(0,i.isUndefined)(W))throw W;{const t=K(a);(0,i.isUndefined)(q)||(t.status="fulfilled",t.value=!0),u(t)}}return{mutate:Q,get data(){return I.data=!0,q},get error(){return I.error=!0,W},get isValidating(){return I.isValidating=!0,J},get isLoading(){return I.isLoading=!0,X}}})))}}]);